<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#002F87">
<title>Halifax Port Brief ‚Äî Mar 6‚Äì9, 2026</title>
<style>
:root {
  --bg: #f5f0eb;
  --white: #ffffff;
  --text: #ffffff;
  --text-mid: #e0e0e8;
  --text-light: #b0b0c8;
  --border: #e8e2da;
  --shadow-sm: 0 2px 8px rgba(30,30,60,0.06);
  --shadow-md: 0 4px 20px rgba(30,30,60,0.08);
  --shadow-lg: 0 8px 30px rgba(30,30,60,0.12);
  --shadow-btn: 0 4px 14px rgba(30,30,60,0.15);
  --radius: 18px;
  --radius-sm: 12px;
  --radius-xs: 8px;
  /* HMCS Frederick Rolette color scheme: Royal Blue, White, Gold */
  --royal-blue: #002F87;
  --royal-blue-light: #1E56A0;
  --royal-blue-soft: #e6ecf5;
  --navy-gold: #C5A572;
  --bright-gold: #FFD700;
  --gold-soft: #fff8e6;
  /* Secondary colors for variety */
  --coral: #FF6B6B;
  --coral-soft: #fff0f0;
  --teal: #20B2AA;
  --teal-soft: #e6f7f6;
  --gold: #C5A572;
  --plum: #9B59B6;
  --plum-soft: #f5eef8;
  --ocean: #1E56A0;
  --ocean-soft: #e6ecf5;
  --green: #2ECC71;
  --green-soft: #eafaf1;
  --rose: #E91E63;
  --rose-soft: #fce4ec;
  --slate: #546E7A;
  /* Glassmorphism */
  --glass-bg: rgba(255, 255, 255, 0.15);
  --glass-border: rgba(255, 255, 255, 0.3);
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { font-size: 16px; scroll-behavior: smooth; }
body {
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", system-ui, sans-serif;
  background: linear-gradient(135deg, #001a4d 0%, #002F87 40%, #1E56A0 100%);
  background-size: 400% 400%;
  animation: gradientShift 20s ease infinite;
  color: var(--text);
  min-height: 100dvh;
  -webkit-tap-highlight-color: transparent;
  -webkit-font-smoothing: antialiased;
}
@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}
a { color: inherit; text-decoration: none; }

/* ===== HEADER ===== */
.header {
position: sticky; top: 0; z-index: 100;
background: var(--glass-bg);
backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
border-bottom: 1px solid var(--glass-border);
display: flex; align-items: center; justify-content: space-between;
padding: 10px 16px;
transition: all 0.3s ease;
box-shadow: 0 2px 12px rgba(0,0,0,0.1);
}
.header.scrolled {
box-shadow: 0 2px 12px rgba(0,0,0,0.08);
}
.header-left { display: flex; align-items: center; gap: 10px; }
.header-flag {
width: 38px; height: 38px; border-radius: 12px;
background: linear-gradient(135deg, var(--royal-blue), var(--navy-gold));
display: flex; align-items: center; justify-content: center;
font-size: 1.2rem; box-shadow: 0 2px 8px rgba(0,47,135,0.3);
transition: transform 0.3s ease;
}
.header-flag:hover {
transform: rotate(10deg) scale(1.05);
}
.header-text {}
.header-title {
font-size: 1rem; font-weight: 800; letter-spacing: -0.03em;
background: linear-gradient(135deg, var(--bright-gold), var(--royal-blue-light));
-webkit-background-clip: text; -webkit-text-fill-color: transparent;
background-clip: text;
}
.header-sub { font-size: 0.7rem; color: var(--text-light); font-weight: 600; letter-spacing: 0.02em; }
.header-home {
background: var(--white); border: 1.5px solid var(--border);
color: var(--slate); font-size: 0.8rem; font-weight: 700;
padding: 8px 16px; border-radius: 20px; cursor: pointer;
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
box-shadow: var(--shadow-sm);
}
.header-home:hover {
transform: translateY(-2px);
box-shadow: var(--shadow-md);
border-color: var(--royal-blue);
filter: brightness(1.1);
}
.header-home:active { transform: scale(0.97); box-shadow: var(--shadow-sm); }

/* ===== PAGES ===== */
.page { display: none; padding: 16px 16px 100px; }
.page.active { display: block; animation: pageIn 0.35s cubic-bezier(0.34, 1.3, 0.64, 1); }
@keyframes pageIn {
from { opacity: 0; transform: translateY(12px); }
to { opacity: 1; transform: translateY(0); }
}

/* ===== SCROLL REVEAL ANIMATIONS ===== */
@keyframes fadeSlideUp {
from { opacity: 0; transform: translateY(20px); }
to { opacity: 1; transform: translateY(0); }
}
.card, .accordion-item, .contact-card, .gallery-card, .landing-btn {
animation: fadeSlideUp 0.6s ease-out forwards;
}
.card:nth-child(1), .accordion-item:nth-child(1) { animation-delay: 0.05s; }
.card:nth-child(2), .accordion-item:nth-child(2) { animation-delay: 0.1s; }
.card:nth-child(3), .accordion-item:nth-child(3) { animation-delay: 0.15s; }
.card:nth-child(4), .accordion-item:nth-child(4) { animation-delay: 0.2s; }
.card:nth-child(5), .accordion-item:nth-child(5) { animation-delay: 0.25s; }
.card:nth-child(6), .accordion-item:nth-child(6) { animation-delay: 0.3s; }

@media (prefers-reduced-motion: reduce) {
  html { scroll-behavior: auto; }
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ===== WEATHER ===== */
.weather-status {
  font-size: 0.82rem;
  color: var(--text-mid);
  margin: 8px 0 16px;
}
.weather-current {
  padding: 20px 18px;
  line-height: 1.5;
}
.weather-current-top {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 16px;
  margin-bottom: 16px;
}
.weather-current-left {
  display: flex;
  align-items: center;
  gap: 14px;
  flex: 1;
}
.weather-current img {
  width: 52px;
  height: 52px;
  flex-shrink: 0;
  opacity: 1;
  filter: none;
}
.weather-current-info {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.weather-now-label {
  font-size: 1.5rem;
  font-weight: 800;
  color: var(--white);
  line-height: 1.2;
  letter-spacing: -0.02em;
}
.weather-condition {
  font-size: 1.125rem;
  color: rgba(255, 255, 255, 0.95);
  text-transform: capitalize;
  line-height: 1.3;
}
.weather-current-temp {
  font-size: 3.5rem;
  font-weight: 900;
  color: var(--white);
  line-height: 1;
  letter-spacing: -0.03em;
  text-align: right;
  flex-shrink: 0;
}
.weather-stats-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(255, 255, 255, 0.15);
}
.weather-stat {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  flex: 1;
  min-width: 0;
}
.weather-stat-label {
  font-size: 0.75rem;
  font-weight: 700;
  color: rgba(255, 255, 255, 0.7);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}
.weather-stat-value {
  font-size: 0.95rem;
  font-weight: 700;
  color: rgba(255, 255, 255, 0.95);
  white-space: nowrap;
}
.weather-grid {
  display: grid;
  gap: 10px;
}
.weather-meta {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
  font-size: 0.78rem;
  color: var(--text-light);
}
.weather-empty {
  font-size: 0.82rem;
  color: var(--text-light);
}

/* ===== BACK BUTTON ===== */
.back-btn {
display: inline-flex; align-items: center; gap: 6px;
background: var(--white); border: 1.5px solid var(--border);
color: var(--slate); font-size: 0.82rem; font-weight: 700;
padding: 8px 16px; border-radius: 20px; cursor: pointer;
margin-bottom: 16px; box-shadow: var(--shadow-sm);
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.back-btn::before { content: "‚Äπ"; font-size: 1.2rem; font-weight: 800; line-height: 1; margin-top: -1px; transition: transform 0.3s; }
.back-btn:hover {
transform: translateX(-3px);
box-shadow: var(--shadow-md);
filter: brightness(1.1);
}
.back-btn:hover::before { transform: translateX(-2px); }
.back-btn:active { transform: scale(0.97); }

/* ===== PAGE TITLE ===== */
.page-title {
font-size: 1.6rem; font-weight: 900; letter-spacing: 0.08em;
margin-bottom: 6px; line-height: 1.15;
background: linear-gradient(135deg, var(--white), var(--text-mid));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
}
.page-subtitle { font-size: 0.88rem; color: var(--text-light); font-weight: 500; margin-bottom: 20px; line-height: 1.6; }

/* ===== LANDING HERO ===== */
.landing-hero { text-align: center; padding: 24px 0 8px; }
@keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }
.landing-title {
font-size: 1.8rem; font-weight: 900; letter-spacing: 0.08em;
background: linear-gradient(135deg, var(--bright-gold), var(--white), var(--royal-blue-light));
-webkit-background-clip: text; -webkit-text-fill-color: transparent;
background-clip: text; line-height: 1.15; margin-bottom: 4px;
}
.landing-dates { font-size: 0.92rem; color: var(--text-light); font-weight: 600; margin-bottom: 28px; }

/* ===== LANDING BUTTONS ===== */
.landing-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}
.landing-btn {
display: flex; align-items: center; gap: 12px;
width: 100%; padding: 14px 14px;
background: var(--glass-bg);
backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
border: 1px solid var(--glass-border);
border-radius: var(--radius);
color: var(--white); font-size: 0.9rem; font-weight: 700;
cursor: pointer; text-align: left;
box-shadow: var(--shadow-md);
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
position: relative; overflow: hidden;
letter-spacing: -0.01em;
}
.landing-btn::before {
content: '';
position: absolute;
top: 50%;
left: 50%;
width: 0;
height: 0;
border-radius: 50%;
background: rgba(0, 0, 0, 0.03);
transform: translate(-50%, -50%);
transition: width 0.6s, height 0.6s;
}
.landing-btn:active::before {
width: 300px;
height: 300px;
}
.landing-btn:hover {
transform: translateY(-3px);
box-shadow: var(--shadow-lg);
filter: brightness(1.1);
}
.landing-btn:active { transform: scale(0.97); box-shadow: var(--shadow-sm); }
.landing-btn .icon-wrap {
width: 38px; height: 38px; border-radius: 12px;
display: flex; align-items: center; justify-content: center;
font-size: 1.2rem; flex-shrink: 0;
transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.landing-btn:hover .icon-wrap { transform: scale(1.1) rotate(5deg); }
.landing-btn:active .icon-wrap { transform: scale(1.15) rotate(-4deg); }
.landing-btn .btn-arrow {
margin-left: auto; font-size: 1.1rem; color: var(--text-light);
transition: transform 0.3s;
}
.landing-btn:hover .btn-arrow { transform: translateX(4px); }
.landing-btn:active .btn-arrow { transform: translateX(3px); }
/* Color coding per button */
.lb-routine .icon-wrap { background: var(--ocean-soft); color: var(--ocean); }
.lb-map .icon-wrap { background: var(--green-soft); color: var(--green); }
.lb-todo .icon-wrap { background: var(--gold-soft); color: var(--gold); }
.lb-food .icon-wrap { background: var(--coral-soft); color: var(--coral); }
.lb-hotels .icon-wrap { background: var(--plum-soft); color: var(--plum); }
.lb-safety .icon-wrap { background: var(--teal-soft); color: var(--teal); }
.lb-contacts .icon-wrap { background: var(--ocean-soft); color: var(--ocean); }
.lb-crow .icon-wrap { background: #f5f0e0; color: #8b6914; }
.lb-weather .icon-wrap { background: var(--ocean-soft); color: var(--ocean); }
.lb-explore .icon-wrap { background: var(--green-soft); color: var(--green); }

/* Center single button on its own row */
.landing-btn.full-width {
  grid-column: 1 / -1;
  max-width: 50%;
  margin: 0 auto;
}

/* Staggered entrance */
.landing-btn { opacity: 0; animation: staggerIn 0.4s cubic-bezier(0.34, 1.3, 0.64, 1) forwards; }
.landing-btn:nth-child(1) { animation-delay: 0.04s; }
.landing-btn:nth-child(2) { animation-delay: 0.08s; }
.landing-btn:nth-child(3) { animation-delay: 0.12s; }
.landing-btn:nth-child(4) { animation-delay: 0.16s; }
.landing-btn:nth-child(5) { animation-delay: 0.2s; }
.landing-btn:nth-child(6) { animation-delay: 0.24s; }
.landing-btn:nth-child(7) { animation-delay: 0.28s; }
.landing-btn:nth-child(8) { animation-delay: 0.32s; }
@keyframes staggerIn {
from { opacity: 0; transform: translateY(16px) scale(0.97); }
to { opacity: 1; transform: translateY(0) scale(1); }
}

/* ===== ACCORDION ===== */
.accordion-item {
background: var(--glass-bg);
backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
border: 1px solid var(--glass-border);
border-radius: var(--radius);
margin-bottom: 8px; overflow: hidden;
box-shadow: var(--shadow-sm);
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.accordion-item:hover { box-shadow: var(--shadow-md); transform: translateY(-1px); }
.accordion-item.open { box-shadow: var(--shadow-md); transform: translateY(0); }
.accordion-trigger {
width: 100%; padding: 16px 18px; background: transparent;
border: none; color: var(--text); font-size: 0.95rem; font-weight: 700;
text-align: left; cursor: pointer;
display: flex; justify-content: space-between; align-items: center;
transition: background 0.15s;
letter-spacing: -0.01em;
}
.accordion-trigger:active { background: rgba(0,0,0,0.02); }
.accordion-icon {
width: 28px; height: 28px; border-radius: 50%;
display: flex; align-items: center; justify-content: center;
font-size: 1.1rem; font-weight: 700; color: var(--text-light);
background: var(--bg);
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.accordion-trigger:hover .accordion-icon {
background: rgba(0,47,135,0.1);
transform: scale(1.1);
}
.accordion-item.open .accordion-icon {
background: var(--royal-blue); color: #fff;
transform: rotate(45deg) scale(1.05);
}
.accordion-body {
padding: 0 18px; max-height: 0; overflow: hidden;
transition: max-height 0.3s ease, padding 0.3s ease;
}
.accordion-item.open .accordion-body { max-height: 1200px; padding: 0 18px 18px; }
.accordion-body p, .accordion-body li { font-size: 0.9rem; color: var(--text-mid); line-height: 1.6; }
.accordion-body ul { padding-left: 18px; }
.accordion-body li { margin-bottom: 6px; }
.accordion-media {
margin-top: 12px;
border-radius: 14px;
overflow: hidden;
background: var(--bg);
box-shadow: inset 0 0 0 1px rgba(0,0,0,0.04);
position: relative;
}
.accordion-media::before {
content: '';
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.05) 100%);
pointer-events: none;
z-index: 1;
}
.accordion-media img {
width: 100%;
height: 180px;
object-fit: cover;
display: block;
transition: transform 0.5s ease;
}
.accordion-media:hover img {
transform: scale(1.05);
}

/* ===== MAP LOCATION BUTTONS ===== */
.map-btns { display: flex; flex-direction: column; gap: 8px; margin-bottom: 22px; }
.map-btn {
display: flex; align-items: center; gap: 12px;
padding: 14px 16px; background: var(--white);
border-radius: var(--radius); color: var(--slate);
font-weight: 700; font-size: 0.95rem; cursor: pointer;
text-decoration: none; box-shadow: var(--shadow-sm);
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
min-width: 0;
}
.map-btn:hover {
transform: translateX(4px);
box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
filter: brightness(1.1);
}
.map-btn:active { transform: scale(0.97); box-shadow: var(--shadow-sm); }
.map-pin {
width: 38px; height: 38px; border-radius: 12px;
background: linear-gradient(135deg, var(--green), var(--teal));
display: flex; align-items: center; justify-content: center;
font-size: 1rem; color: #fff; flex-shrink: 0;
box-shadow: 0 3px 10px rgba(46,204,113,0.3);
transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.map-btn:hover .map-pin { transform: scale(1.15) rotate(-5deg); }
.map-btn-label { flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.map-btn-dist { flex-shrink: 0; color: var(--text-light); font-size: 0.82rem; font-weight: 600; white-space: nowrap; }
.map-btn .chevron { flex-shrink: 0; margin-left: 4px; color: var(--text-light); font-size: 1.1rem; transition: transform 0.3s; }
.map-btn:hover .chevron { transform: translateX(3px); }

/* ===== MAP OVERVIEW ===== */
.map-embed-wrap {
  border-radius: var(--radius);
  overflow: hidden;
  margin-bottom: 20px;
  box-shadow: var(--shadow-md);
  border: 1px solid var(--glass-border);
}
.map-embed-wrap iframe {
  width: 100%;
  height: 220px;
  border: 0;
  display: block;
}

/* ===== MAP SECTION ACCORDION ===== */
.map-section {
  background: var(--glass-bg);
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  margin-bottom: 10px;
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  transition: all 0.3s ease;
}
.map-section:hover { box-shadow: var(--shadow-md); }
.map-section-trigger {
  width: 100%; padding: 14px 16px; background: transparent;
  border: none; color: var(--text); font-size: 0.92rem; font-weight: 700;
  text-align: left; cursor: pointer;
  display: flex; align-items: center; gap: 12px;
  transition: background 0.15s;
}
.map-section-trigger:active { background: rgba(0,0,0,0.02); }
.map-section-icon {
  width: 34px; height: 34px; border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-size: 1rem; flex-shrink: 0;
}
.map-section-count {
  margin-left: auto;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--text-light);
  background: rgba(255,255,255,0.1);
  padding: 3px 10px;
  border-radius: 10px;
}
.map-section-chevron {
  font-size: 1rem; color: var(--text-light);
  transition: transform 0.3s ease;
  flex-shrink: 0;
}
.map-section.open .map-section-chevron { transform: rotate(90deg); }
.map-section-body {
  padding: 0 12px;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.35s ease, padding 0.35s ease;
}
.map-section.open .map-section-body { max-height: 3000px; padding: 0 12px 14px; }

/* ===== TRANSPORT CARDS ===== */
.transport-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-bottom: 16px;
}
.transport-card {
  background: var(--glass-bg);
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 16px;
  text-align: center;
  box-shadow: var(--shadow-sm);
  transition: all 0.3s ease;
  text-decoration: none;
  color: var(--text);
  cursor: pointer;
}
.transport-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
.transport-card-icon { font-size: 1.8rem; margin-bottom: 6px; }
.transport-card-name { font-weight: 800; font-size: 0.88rem; margin-bottom: 2px; }
.transport-card-sub { font-size: 0.75rem; color: var(--text-light); }

/* Taxi list compact */
.taxi-list { display: flex; flex-direction: column; gap: 8px; margin-top: 12px; }
.taxi-item {
  display: flex; align-items: center; gap: 12px;
  background: var(--glass-bg);
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-sm);
  padding: 12px 14px;
  box-shadow: var(--shadow-sm);
  transition: all 0.3s ease;
}
.taxi-item:hover { box-shadow: var(--shadow-md); transform: translateY(-1px); }
.taxi-info { flex: 1; min-width: 0; }
.taxi-name { font-weight: 700; font-size: 0.88rem; }
.taxi-sub { font-size: 0.75rem; color: var(--text-light); }
.taxi-item .btn-sm { flex-shrink: 0; }

/* ===== FILTER CHIPS ===== */
.chips { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; }
.chip {
padding: 8px 16px; border-radius: 20px;
background: var(--white); border: 1.5px solid var(--border);
color: var(--slate); font-size: 0.8rem; font-weight: 700;
cursor: pointer;
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
user-select: none; box-shadow: var(--shadow-sm);
position: relative;
overflow: hidden;
}
.chip::before {
content: '';
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 100%;
background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
transition: left 0.5s;
}
.chip:hover::before {
left: 100%;
}
.chip:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
.chip:active { transform: scale(0.95); }
.chip.active {
background: linear-gradient(135deg, var(--royal-blue), var(--navy-gold));
color: #fff; border-color: transparent;
box-shadow: 0 3px 12px rgba(0,47,135,0.3);
transform: translateY(-2px);
}

.empty-state {
background: rgba(255, 255, 255, 0.12);
border: 1px dashed rgba(255, 255, 255, 0.35);
border-radius: 14px;
padding: 14px;
font-size: 0.85rem;
color: var(--text-light);
text-align: center;
margin-top: 10px;
}

/* ===== CARDS ===== */
.card {
background: var(--glass-bg);
backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
border: 1px solid var(--glass-border);
border-radius: var(--radius);
padding: 16px 18px; margin-bottom: 10px;
box-shadow: var(--shadow-sm);
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.card:hover {
transform: translateY(-2px);
box-shadow: var(--shadow-md);
}
.card-name { font-weight: 800; font-size: 1rem; margin-bottom: 2px; letter-spacing: -0.02em; color: var(--white); }
.card-note { font-size: 0.84rem; color: var(--text-light); margin-bottom: 10px; line-height: 1.6; }
.price-badge {
display: inline-block; font-size: 0.72rem; font-weight: 800; color: var(--green);
background: var(--green-soft); padding: 2px 8px; border-radius: 6px; letter-spacing: 0.02em;
white-space: nowrap; flex-shrink: 0;
box-shadow: 0 0 0 1px rgba(46,204,113,0.1);
transition: all 0.3s ease;
}
.card:hover .price-badge {
box-shadow: 0 0 8px rgba(46,204,113,0.2);
}
.card-tags { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 10px; }
.card-tag {
font-size: 0.7rem; font-weight: 700; padding: 3px 10px;
border-radius: 10px; background: var(--bg); color: var(--text-light);
letter-spacing: 0.01em;
}

/* ===== ACTION BUTTONS ===== */
.card-actions { display: flex; gap: 8px; flex-wrap: wrap; }
.btn-sm {
display: inline-flex; align-items: center; gap: 5px;
padding: 9px 16px; border-radius: 12px;
font-size: 0.8rem; font-weight: 700; cursor: pointer;
border: none; text-decoration: none;
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
box-shadow: var(--shadow-sm);
position: relative;
overflow: hidden;
}
.btn-sm::before {
content: '';
position: absolute;
top: 50%;
left: 50%;
width: 0;
height: 0;
border-radius: 50%;
background: rgba(255, 255, 255, 0.3);
transform: translate(-50%, -50%);
transition: width 0.4s, height 0.4s;
}
.btn-sm:active::before {
width: 100px;
height: 100px;
}
.btn-sm:hover {
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
filter: brightness(1.15);
}
.btn-sm:active {
transform: scale(0.97);
box-shadow: var(--shadow-sm);
}
.btn-map { background: var(--green-soft); color: #1a9660; }
.btn-map:hover { box-shadow: 0 6px 20px rgba(46,204,113,0.4); }
.btn-web { background: var(--ocean-soft); color: #2074a8; }
.btn-web:hover { box-shadow: 0 6px 20px rgba(52,152,219,0.4); }
.btn-call {
background: linear-gradient(135deg, var(--royal-blue), var(--royal-blue-light));
color: #fff;
box-shadow: 0 3px 12px rgba(0,47,135,0.3);
}
.btn-call:hover { box-shadow: 0 6px 20px rgba(0,47,135,0.5); }
.btn-text { background: var(--gold-soft); color: #c07b00; }
.btn-text:hover { box-shadow: 0 6px 20px rgba(244,166,35,0.4); }

/* ===== TABS ===== */
.tabs {
display: flex; gap: 4px; margin-bottom: 16px;
background: var(--glass-bg);
backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
border: 1px solid var(--glass-border);
padding: 4px; border-radius: 16px;
box-shadow: var(--shadow-sm);
}
.tab {
flex: 1; padding: 10px 6px; text-align: center;
background: transparent; border: none; border-radius: 12px;
color: var(--text-light); font-size: 0.82rem; font-weight: 700;
cursor: pointer; transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
position: relative;
overflow: hidden;
}
.tab::before {
content: '';
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: rgba(0, 0, 0, 0.03);
opacity: 0;
transition: opacity 0.3s;
}
.tab:hover::before {
opacity: 1;
}
.tab.active {
background: linear-gradient(135deg, var(--royal-blue), var(--navy-gold));
color: #fff;
box-shadow: 0 2px 10px rgba(0,47,135,0.25);
}
.tab.active::before {
opacity: 0;
}
.tab:active { transform: scale(0.97); }
.tab-panel { display: none; }
.tab-panel.active { display: block; }

/* ===== QUICK HOME BUTTON ===== */
.quick-home {
position: fixed;
right: 16px;
bottom: 20px;
z-index: 120;
display: inline-flex;
align-items: center;
gap: 8px;
padding: 10px 14px;
border-radius: 20px;
border: 1px solid rgba(255, 255, 255, 0.35);
background: rgba(0, 47, 135, 0.9);
color: #fff;
font-size: 0.82rem;
font-weight: 700;
box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
cursor: pointer;
opacity: 0;
pointer-events: none;
transform: translateY(10px);
transition: all 0.3s ease;
}
.quick-home.show {
opacity: 1;
pointer-events: auto;
transform: translateY(0);
}

/* ===== SEARCH ===== */
.search-input {
width: 100%; padding: 13px 16px; border-radius: 14px;
background: var(--white); border: 1.5px solid var(--border);
color: var(--slate); font-size: 0.92rem; font-weight: 500;
margin-bottom: 14px; outline: none;
box-shadow: var(--shadow-sm);
transition: all 0.3s ease;
}
.search-input::placeholder { color: var(--text-light); }
.search-input:focus {
border-color: var(--royal-blue);
box-shadow: 0 0 0 3px rgba(0,47,135,0.12), var(--shadow-md);
transform: translateY(-1px);
}

/* ===== EMERGENCY ===== */
.emergency-box {
display: flex; align-items: center; justify-content: center; gap: 10px;
background: linear-gradient(135deg, var(--coral), #ff4757);
color: #fff; font-weight: 800; font-size: 1.1rem;
padding: 18px; border-radius: var(--radius);
margin-bottom: 16px; text-decoration: none;
box-shadow: 0 4px 16px rgba(255,71,87,0.3);
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
animation: pulse 2s ease-in-out infinite;
}
.emergency-box:hover {
transform: scale(1.02);
box-shadow: 0 6px 20px rgba(255,71,87,0.4);
}
.emergency-box:active { transform: scale(0.98); }
@keyframes pulse {
0%, 100% { box-shadow: 0 4px 16px rgba(255,71,87,0.3); }
50% { box-shadow: 0 4px 20px rgba(255,71,87,0.5); }
}

/* ===== CONTACT CARD ===== */
.contact-card {
background: var(--glass-bg);
backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
border: 1px solid var(--glass-border);
border-radius: var(--radius);
padding: 18px; margin-bottom: 10px;
box-shadow: var(--shadow-sm);
transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.contact-card:hover {
transform: translateY(-2px);
box-shadow: var(--shadow-md);
}
.contact-label { font-weight: 800; font-size: 1rem; margin-bottom: 4px; letter-spacing: -0.02em; }
.contact-sub { font-size: 0.82rem; color: var(--text-light); margin-bottom: 12px; }
.contact-actions { display: flex; gap: 8px; flex-wrap: wrap; }

/* ===== SECTION HEADER ===== */
.section-header {
font-size: 0.75rem; font-weight: 800; color: var(--text-light);
text-transform: uppercase; letter-spacing: 0.1em;
margin: 22px 0 10px; padding-left: 2px;
}

/* ===== PLACEHOLDER BLOCKS ===== */
.placeholder-text { color: var(--text-light); font-style: italic; font-size: 0.9rem; line-height: 1.6; }
.placeholder-block {
background: var(--white); border: 2px dashed var(--border);
border-radius: var(--radius); padding: 16px 18px; margin-bottom: 10px;
}

/* ===== DECORATIVE DOT PATTERN ===== */
.dot-pattern {
position: fixed; top: 0; left: 0; right: 0; bottom: 0;
pointer-events: none; z-index: -1; opacity: 0.35;
background-image: radial-gradient(circle, var(--border) 1px, transparent 1px);
background-size: 24px 24px;
animation: dotMove 20s linear infinite;
}
@keyframes dotMove {
0% { background-position: 0 0; }
100% { background-position: 24px 24px; }
}

/* ===== COLOR BAR on pages ===== */
.color-bar {
height: 4px; border-radius: 4px; margin-bottom: 16px;
background: linear-gradient(90deg, var(--royal-blue), var(--navy-gold), var(--bright-gold), var(--royal-blue-light), var(--white));
background-size: 200% 100%;
animation: colorShift 8s ease-in-out infinite;
}
@keyframes colorShift {
0%, 100% { background-position: 0% 50%; }
50% { background-position: 100% 50%; }
}

/* ===== CROW'S NEST ‚Äî OLD NAVY HERITAGE THEME ===== */
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400&family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&display=swap');

#crowsnest {
  --cn-navy: #0a1628;
  --cn-navy-mid: #152238;
  --cn-navy-light: #1e3050;
  --cn-gold: #c9a84c;
  --cn-gold-light: #e8d48b;
  --cn-gold-dim: #8b7a3e;
  --cn-cream: #f0e6d3;
  --cn-cream-dark: #d4c4a8;
  --cn-parchment: #faf4e8;
  --cn-rust: #8b4513;
  --cn-red: #8b2500;
  --cn-rope: #c4a265;
}
#crowsnest.page {
  background: linear-gradient(175deg, #0a1628 0%, #152238 30%, #1a2a42 60%, #0f1d30 100%);
  padding: 0 0 80px;
  position: relative;
}
#crowsnest.page.active { display: block; }

/* --- Decorative background texture --- */
#crowsnest::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image:
    radial-gradient(circle at 20% 50%, rgba(201,168,76,0.03) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(201,168,76,0.02) 0%, transparent 40%),
    url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23c9a84c' fill-opacity='0.025'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 0;
}
#crowsnest > * { position: relative; z-index: 1; }

/* --- Back button override --- */
#crowsnest .back-btn {
  margin: 16px 16px 0;
  background: rgba(201,168,76,0.12);
  border: 1px solid rgba(201,168,76,0.25);
  color: var(--cn-gold-light);
  font-family: 'Crimson Text', Georgia, serif;
  font-weight: 600;
  letter-spacing: 0.03em;
}
#crowsnest .back-btn::before { color: var(--cn-gold); }
#crowsnest .back-btn:hover {
  background: rgba(201,168,76,0.2);
  border-color: var(--cn-gold);
}

/* --- Hero banner --- */
.cn-hero {
  position: relative;
  padding: 32px 20px 28px;
  text-align: center;
  overflow: hidden;
}
.cn-hero::before {
  content: '';
  position: absolute;
  top: -20px; left: -20px; right: -20px; bottom: -20px;
  background: radial-gradient(ellipse at center, rgba(201,168,76,0.08) 0%, transparent 70%);
  pointer-events: none;
}
.cn-hero-badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 18px;
  background: rgba(201,168,76,0.1);
  border: 1px solid rgba(201,168,76,0.3);
  border-radius: 20px;
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.78rem;
  font-weight: 600;
  color: var(--cn-gold);
  letter-spacing: 0.12em;
  text-transform: uppercase;
  margin-bottom: 16px;
}
.cn-hero-title {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 2.2rem;
  font-weight: 900;
  color: var(--cn-cream);
  line-height: 1.1;
  letter-spacing: 0.02em;
  margin-bottom: 8px;
  text-shadow: 0 2px 20px rgba(0,0,0,0.3);
}
.cn-hero-est {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 1rem;
  color: var(--cn-gold);
  font-weight: 600;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  margin-bottom: 6px;
}
.cn-hero-designation {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.82rem;
  color: var(--cn-cream-dark);
  font-style: italic;
  opacity: 0.8;
}

/* --- Gold divider line --- */
.cn-divider {
  height: 1px;
  margin: 0 20px;
  background: linear-gradient(90deg, transparent 0%, var(--cn-gold-dim) 20%, var(--cn-gold) 50%, var(--cn-gold-dim) 80%, transparent 100%);
  opacity: 0.5;
}
.cn-divider-ornament {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin: 16px 20px;
  color: var(--cn-gold-dim);
  font-size: 0.7rem;
  letter-spacing: 0.3em;
  text-transform: uppercase;
  font-family: 'Crimson Text', Georgia, serif;
}
.cn-divider-ornament::before,
.cn-divider-ornament::after {
  content: '';
  flex: 1;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(201,168,76,0.4), transparent);
}

/* --- Intro quote block --- */
.cn-intro {
  margin: 20px 16px;
  padding: 24px 22px;
  background: linear-gradient(135deg, rgba(201,168,76,0.06) 0%, rgba(10,22,40,0.4) 100%);
  border: 1px solid rgba(201,168,76,0.15);
  border-left: 3px solid var(--cn-gold);
  border-radius: 4px;
  position: relative;
}
.cn-intro::before {
  content: '\201C';
  position: absolute;
  top: 8px;
  left: 12px;
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 3rem;
  color: rgba(201,168,76,0.15);
  line-height: 1;
}
.cn-intro p {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 1.02rem;
  color: var(--cn-cream);
  line-height: 1.8;
  font-style: italic;
}
.cn-intro .cn-intro-source {
  display: block;
  margin-top: 12px;
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.82rem;
  color: var(--cn-gold-dim);
  font-style: normal;
  letter-spacing: 0.03em;
}

/* --- At a Glance quick facts --- */
.cn-glance {
  margin: 24px 16px 20px;
}
.cn-glance-title {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--cn-gold);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  margin-bottom: 12px;
  padding-left: 2px;
}
.cn-glance-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}
.cn-glance-item {
  padding: 14px 14px;
  background: rgba(201,168,76,0.04);
  border: 1px solid rgba(201,168,76,0.12);
  border-radius: 6px;
  text-align: center;
  transition: all 0.3s ease;
}
.cn-glance-item:hover {
  background: rgba(201,168,76,0.08);
  border-color: rgba(201,168,76,0.25);
}
.cn-glance-icon {
  font-size: 1.3rem;
  margin-bottom: 6px;
  display: block;
}
.cn-glance-label {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.72rem;
  font-weight: 600;
  color: var(--cn-gold-dim);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 3px;
}
.cn-glance-value {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 0.88rem;
  font-weight: 700;
  color: var(--cn-cream);
  line-height: 1.3;
}

/* --- Section blocks --- */
.cn-section {
  margin: 0 16px 20px;
  padding: 24px 20px;
  background: linear-gradient(180deg, rgba(21,34,56,0.9) 0%, rgba(15,29,48,0.95) 100%);
  border: 1px solid rgba(201,168,76,0.1);
  border-radius: 6px;
  position: relative;
  overflow: hidden;
}
.cn-section::after {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent, rgba(201,168,76,0.3), transparent);
}
.cn-section-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 16px;
}
.cn-section-number {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 1.6rem;
  font-weight: 900;
  color: rgba(201,168,76,0.2);
  line-height: 1;
  min-width: 28px;
}
.cn-section-title {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 1.15rem;
  font-weight: 700;
  color: var(--cn-cream);
  line-height: 1.2;
}
.cn-section-subtitle {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.78rem;
  color: var(--cn-gold-dim);
  font-style: italic;
  margin-top: 2px;
}
.cn-section p {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.95rem;
  color: var(--cn-cream-dark);
  line-height: 1.85;
  margin-bottom: 14px;
}
.cn-section p:last-of-type { margin-bottom: 0; }
.cn-section strong { color: var(--cn-cream); font-weight: 700; }
.cn-section em { color: var(--cn-gold-light); }

/* --- Section images --- */
.cn-section-img {
  margin-top: 18px;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  border: 1px solid rgba(201,168,76,0.15);
}
.cn-section-img::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(to bottom, transparent 60%, rgba(10,22,40,0.4) 100%);
  pointer-events: none;
}
.cn-section-img img {
  width: 100%;
  height: 200px;
  object-fit: cover;
  display: block;
  filter: sepia(15%) contrast(1.05);
  transition: filter 0.5s ease, transform 0.5s ease;
}
.cn-section-img:hover img {
  filter: sepia(5%) contrast(1.1);
  transform: scale(1.03);
}
.cn-section-img-caption {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 10px 14px;
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.75rem;
  font-style: italic;
  color: var(--cn-cream-dark);
  z-index: 2;
  text-shadow: 0 1px 4px rgba(0,0,0,0.5);
}

/* --- Notable quote callout --- */
.cn-callout {
  margin: 0 16px 20px;
  padding: 20px 22px;
  background: rgba(139,69,19,0.08);
  border: 1px solid rgba(201,168,76,0.15);
  border-radius: 4px;
  text-align: center;
}
.cn-callout-text {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 1.05rem;
  font-weight: 400;
  font-style: italic;
  color: var(--cn-cream);
  line-height: 1.7;
  margin-bottom: 8px;
}
.cn-callout-attr {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.78rem;
  color: var(--cn-gold-dim);
  letter-spacing: 0.05em;
}

/* --- Timeline --- */
.cn-timeline {
  margin: 0 16px 24px;
  padding: 24px 20px;
  background: linear-gradient(180deg, rgba(21,34,56,0.9) 0%, rgba(15,29,48,0.95) 100%);
  border: 1px solid rgba(201,168,76,0.1);
  border-radius: 6px;
  position: relative;
}
.cn-timeline::after {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent, rgba(201,168,76,0.3), transparent);
}
.cn-timeline-title {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 1.15rem;
  font-weight: 700;
  color: var(--cn-cream);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
}
.cn-timeline-list {
  position: relative;
  padding-left: 24px;
  list-style: none;
}
.cn-timeline-list::before {
  content: '';
  position: absolute;
  left: 6px;
  top: 4px;
  bottom: 4px;
  width: 2px;
  background: linear-gradient(180deg, var(--cn-gold) 0%, var(--cn-gold-dim) 50%, rgba(201,168,76,0.15) 100%);
  border-radius: 2px;
}
.cn-timeline-item {
  position: relative;
  margin-bottom: 18px;
  padding-bottom: 0;
}
.cn-timeline-item:last-child { margin-bottom: 0; }
.cn-timeline-item::before {
  content: '';
  position: absolute;
  left: -21px;
  top: 7px;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--cn-navy);
  border: 2px solid var(--cn-gold);
  z-index: 1;
}
.cn-timeline-item.cn-tl-highlight::before {
  background: var(--cn-gold);
  box-shadow: 0 0 8px rgba(201,168,76,0.4);
}
.cn-timeline-year {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 0.85rem;
  font-weight: 900;
  color: var(--cn-gold);
  margin-bottom: 2px;
  letter-spacing: 0.02em;
}
.cn-timeline-text {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.88rem;
  color: var(--cn-cream-dark);
  line-height: 1.6;
}

/* --- Photo gallery strip --- */
.cn-gallery {
  margin: 0 16px 24px;
}
.cn-gallery-title {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--cn-gold);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  margin-bottom: 12px;
  padding-left: 2px;
}
.cn-gallery-strip {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 8px;
  scrollbar-width: none;
}
.cn-gallery-strip::-webkit-scrollbar { display: none; }
.cn-gallery-item {
  flex: 0 0 72%;
  scroll-snap-align: start;
  border-radius: 6px;
  overflow: hidden;
  border: 1px solid rgba(201,168,76,0.15);
  position: relative;
  background: var(--cn-navy);
}
.cn-gallery-item img {
  width: 100%;
  height: 180px;
  object-fit: cover;
  display: block;
  filter: sepia(10%) contrast(1.05);
  transition: filter 0.4s ease;
}
.cn-gallery-item:hover img { filter: sepia(0%) contrast(1.1); }
.cn-gallery-item-caption {
  padding: 10px 12px;
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.78rem;
  color: var(--cn-cream-dark);
  font-style: italic;
  background: rgba(10,22,40,0.9);
}

/* --- Visiting info panel --- */
.cn-visit {
  margin: 0 16px 24px;
  padding: 24px 20px;
  background: linear-gradient(135deg, rgba(201,168,76,0.06) 0%, rgba(10,22,40,0.6) 100%);
  border: 1px solid rgba(201,168,76,0.2);
  border-radius: 6px;
  position: relative;
}
.cn-visit::before {
  content: '';
  position: absolute;
  top: -1px; left: 20px; right: 20px;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--cn-gold), transparent);
  border-radius: 2px;
}
.cn-visit-title {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--cn-cream);
  margin-bottom: 18px;
  display: flex;
  align-items: center;
  gap: 10px;
}
.cn-visit-row {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  margin-bottom: 14px;
  padding-bottom: 14px;
  border-bottom: 1px solid rgba(201,168,76,0.08);
}
.cn-visit-row:last-of-type { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
.cn-visit-icon {
  font-size: 1.1rem;
  flex-shrink: 0;
  margin-top: 2px;
  opacity: 0.7;
}
.cn-visit-label {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.78rem;
  font-weight: 700;
  color: var(--cn-gold-dim);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: 3px;
}
.cn-visit-value {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.9rem;
  color: var(--cn-cream);
  line-height: 1.6;
}
.cn-visit-hours {
  list-style: none;
  padding: 0;
}
.cn-visit-hours li {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.88rem;
  color: var(--cn-cream-dark);
  line-height: 1.7;
  display: flex;
  justify-content: space-between;
  gap: 8px;
}
.cn-visit-hours li strong {
  color: var(--cn-cream);
  min-width: 80px;
}
.cn-visit-note {
  margin-top: 14px;
  padding: 12px 14px;
  background: rgba(201,168,76,0.05);
  border-radius: 4px;
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.82rem;
  color: var(--cn-cream-dark);
  line-height: 1.6;
  font-style: italic;
}

/* --- Action links (bottom) --- */
.cn-actions {
  display: flex;
  gap: 10px;
  margin: 0 16px 24px;
  flex-wrap: wrap;
}
.cn-action-btn {
  flex: 1;
  min-width: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 14px 12px;
  background: rgba(201,168,76,0.08);
  border: 1px solid rgba(201,168,76,0.2);
  border-radius: 6px;
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.85rem;
  font-weight: 700;
  color: var(--cn-gold);
  text-decoration: none;
  letter-spacing: 0.04em;
  transition: all 0.3s ease;
}
.cn-action-btn:hover {
  background: rgba(201,168,76,0.15);
  border-color: var(--cn-gold);
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(201,168,76,0.15);
}

/* --- Closing footer --- */
.cn-footer {
  margin: 8px 16px 0;
  padding: 20px;
  text-align: center;
  border-top: 1px solid rgba(201,168,76,0.1);
}
.cn-footer-text {
  font-family: 'Crimson Text', Georgia, serif;
  font-size: 0.78rem;
  color: var(--cn-gold-dim);
  font-style: italic;
  line-height: 1.7;
  opacity: 0.7;
}
</style>

</head>
<body>

<div class="dot-pattern"></div>

<!-- HEADER -->

<div class="header">
  <div class="header-left">
    <div class="header-flag">‚öì</div>
    <div class="header-text">
      <div class="header-title">Halifax Port Brief</div>
      <div class="header-sub">Mar 6 ‚Äì 9, 2026 ¬∑ Nova Scotia</div>
    </div>
  </div>
  <button class="header-home" onclick="nav('landing')">üè† Home</button>
</div>

<!-- ===== LANDING ===== -->

<div id="landing" class="page active">
  <div class="landing-hero">
    <div class="landing-title">Welcome to<br>Halifax</div>
    <div class="landing-dates">Mar 6 ‚Äì 9, 2026 &nbsp;¬∑&nbsp; Nova Scotia</div>
  </div>

  <div class="landing-grid">
    <button class="landing-btn lb-routine" onclick="nav('routine')">
      <span class="icon-wrap">‚öì</span>
      <span>Ship Routine &amp; Leave</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
    <button class="landing-btn lb-contacts" onclick="nav('contacts')">
      <span class="icon-wrap">üìû</span>
      <span>Contacts</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
    <button class="landing-btn lb-map" onclick="nav('explore')">
      <span class="icon-wrap">üß≠</span>
      <span>Explore Halifax</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
    <button class="landing-btn lb-hotels" onclick="nav('hotels')">
      <span class="icon-wrap">üè®</span>
      <span>Hotels</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
    <button class="landing-btn lb-weather" onclick="nav('weather')">
      <span class="icon-wrap">üå®Ô∏è</span>
      <span>Weather</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
    <button class="landing-btn lb-safety" onclick="nav('safety')">
      <span class="icon-wrap">üõ°Ô∏è</span>
      <span>Safety</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
    <button class="landing-btn lb-crow full-width" onclick="nav('crowsnest')">
      <span class="icon-wrap">&#9875;</span>
      <span>HMCS Sackville</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
  </div>
</div>

<!-- ===== PAGE 1: SHIP ROUTINE & LEAVE ===== -->

<div id="routine" class="page">
  <button class="back-btn" onclick="nav('landing')">Home</button>
  <div class="page-title">Ship Routine &amp; Leave</div>
  <div class="page-subtitle">Port of Halifax ¬∑ Mar 6‚Äì9, 2026</div>
  <div class="color-bar"></div>

  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Port Window <span class="accordion-icon">+</span></button>
    <div class="accordion-body"><p>Mar 6‚Äì9 (Halifax, NS)</p></div>
  </div>
  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Tours / Admin <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">Tour for CLA:</p>
      <ul>
        <li><strong>6 Mar:</strong> 15 Pers, 1230-1330 lunch, 1330-1530 tour</li>
        <li><strong>7 Mar:</strong> 40 Cadets, 10-11</li>
        <li><strong>7 Mar:</strong> 15 Pers, 10-11 and 11-12</li>
      </ul>
    </div>
  </div>
  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Daily Routine <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <table style="width:100%;border-collapse:collapse;font-size:0.88rem;line-height:1.6;color:var(--text-mid);">
        <thead>
          <tr style="border-bottom:1px solid rgba(255,255,255,0.2);">
            <th style="text-align:left;padding:8px 4px;font-weight:700;color:var(--white);">Date</th>
            <th style="text-align:left;padding:8px 4px;font-weight:700;color:var(--white);">Routine</th>
            <th style="text-align:left;padding:8px 4px;font-weight:700;color:var(--white);">Leave Expires</th>
            <th style="text-align:left;padding:8px 4px;font-weight:700;color:var(--white);">Overnight</th>
          </tr>
        </thead>
        <tbody>
          <tr style="border-bottom:1px solid rgba(255,255,255,0.1);">
            <td style="padding:8px 4px;"><strong>6 Mar</strong></td>
            <td style="padding:8px 4px;">Arrive alongside / Daily Routine</td>
            <td style="padding:8px 4px;">0730 (7 Mar)</td>
            <td style="padding:8px 4px;">Yes</td>
          </tr>
          <tr style="border-bottom:1px solid rgba(255,255,255,0.1);">
            <td style="padding:8px 4px;"><strong>7 Mar</strong></td>
            <td style="padding:8px 4px;">Weekend Routine</td>
            <td style="padding:8px 4px;">0730 (8 Mar)</td>
            <td style="padding:8px 4px;">Yes</td>
          </tr>
          <tr style="border-bottom:1px solid rgba(255,255,255,0.1);">
            <td style="padding:8px 4px;"><strong>8 Mar</strong></td>
            <td style="padding:8px 4px;">Sunday Routine</td>
            <td style="padding:8px 4px;">2359</td>
            <td style="padding:8px 4px;">No</td>
          </tr>
          <tr>
            <td style="padding:8px 4px;"><strong>9 Mar</strong></td>
            <td style="padding:8px 4px;">Departure</td>
            <td style="padding:8px 4px;">N/A</td>
            <td style="padding:8px 4px;">N/A</td>
          </tr>
        </tbody>
      </table>
      <p style="margin-top:12px;font-size:0.84rem;color:var(--text-light);">See Routine Orders for detailed timings.</p>
    </div>
  </div>
  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Sick Parade <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <p><strong>Sick Parade Schedule:</strong></p>
      <ul>
        <li>Saturday, Mar 7: 0800‚Äì0900</li>
        <li>Sunday, Mar 8: 0800‚Äì0900</li>
      </ul>
      <p>For urgent medical cases while personnel are off ship, the Duty Medical person can be reached via the Duty Medical phone outside sick parade hours. For any emergency medical situations, call 911.</p>
    </div>
  </div>
  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Leave <span class="accordion-icon">+</span></button>
    <div class="accordion-body"><p>Per Routine Orders.</p></div>
  </div>
  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Overnight Leave <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <p style="margin-bottom:12px;"><strong>Overnight leave may be authorized during this port visit when approved.</strong></p>

      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">Location Requirements:</p>
      <ul style="margin-bottom:12px;">
        <li>Must be within a 4-hour return boundary (able to return within 4 hours if recalled)</li>
      </ul>

      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">Leave Pass Requirements:</p>
      <ul style="margin-bottom:12px;">
        <li>Include: address, contact info, hotel/residence confirmation number</li>
        <li>Submit to HOD/SHOD NLT 1800 on the night you want overnight leave</li>
        <li>May cover multiple days</li>
        <li>If HOD/SHOD absent, DPO/OOD can sign leave pass(es)</li>
        <li>Copy #1: placed in Quarter Master Lobby binder</li>
        <li>Copy #2: placed on top of your bunk (cabin/mess)</li>
      </ul>

      <div style="background:rgba(233,30,99,0.15);border-left:3px solid var(--rose);padding:12px;border-radius:8px;margin-bottom:12px;">
        <p style="font-weight:800;color:var(--white);margin-bottom:6px;">‚ö†Ô∏è CHECK-IN REQUIRED</p>
        <ul>
          <li><strong>When:</strong> Following morning between 0700‚Äì1100</li>
          <li><strong>How:</strong> Phone or email to <a href="mailto:FRRcheckin@forces.gc.ca" style="color:var(--bright-gold);text-decoration:underline;">FRRcheckin@forces.gc.ca</a></li>
          <li><strong>Confirmation:</strong> You are NOT checked-in until told "You have been checked-in"</li>
          <li><strong style="color:#ff4757;">CRITICAL:</strong> Check-in after 1100 = Tardy/AWOL</li>
          <li>If unable to check-in by phone/email, physically report to the ship</li>
        </ul>
      </div>

      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">General Reminders:</p>
      <ul>
        <li>Have hotel name, address, and phone number ready before requesting leave</li>
        <li>Provide contact number where you can be reached at all times</li>
        <li>Know your leave expiry time and plan return travel accordingly</li>
        <li>If plans change, inform the ship per routine as soon as possible</li>
        <li>Keep military ID and leave pass on your person</li>
      </ul>
    </div>
  </div>
  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Duty Watches <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">Dress Code:</p>
      <ul style="margin-bottom:12px;">
        <li>While on duty/working onboard: NCD (Naval Combat Dress)</li>
        <li>Dress for the weather</li>
      </ul>

      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">Sunday Routine Cleaning:</p>
      <ul style="margin-bottom:12px;">
        <li>Oncoming and off-going duty watches conduct cleaning stations before off-going watch secured</li>
        <li>Tasks: sweep flats, empty gash, clean scullery</li>
      </ul>

      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">Watch Turnover:</p>
      <ul style="margin-bottom:12px;">
        <li>Daily at 0805 after off-going watch completes Colours</li>
        <li><strong>Important:</strong> Duty watch of 8 Mar remains in place until ship closes up for departure on 9 Mar</li>
      </ul>

      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">Contact Information:</p>
      <ul>
        <li>Paper cards listing ship phone numbers available at the Brow</li>
        <li>Command Team can be contacted at any time ‚Äî reach out if you need help</li>
      </ul>
    </div>
  </div>
  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Cannabis Policy <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <div style="background:rgba(155,89,182,0.15);border-left:3px solid var(--plum);padding:12px;border-radius:8px;margin-bottom:12px;">
        <p style="font-weight:800;color:var(--white);margin-bottom:6px;">Cannabis consumption is governed IAW DAOD 9004-1</p>
        <p style="font-size:0.84rem;color:var(--text-mid);margin-bottom:0;">CAF policy applies regardless of Canadian or local laws</p>
      </div>

      <p style="margin-bottom:8px;"><strong>What counts as "authorized leave"?</strong></p>
      <p style="margin-bottom:12px;font-size:0.88rem;color:var(--text-mid);">FRR considers Sunday Routine to mean "authorized leave," along with anyone holding an approved overnight leave pass. However, restrictions still apply.</p>

      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">Restrictions:</p>
      <ul>
        <li><strong>No cannabis 8 hrs before duty</strong></li>
        <li><strong>No cannabis 24 hrs before operation of weapons/ammunition/explosives</strong></li>
        <li><strong>No cannabis 24 hrs before scheduled emergency response</strong></li>
        <li><strong>No cannabis 24 hrs before scheduled operational exercise or training</strong> (day prior to sailing)</li>
      </ul>
    </div>
  </div>
  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Smoking <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <ul>
        <li>Smoking restricted to Quarter Deck only</li>
        <li>Specific side (inboard/outboard) will be determined upon arrival</li>
      </ul>
    </div>
  </div>
  <div class="accordion-item" data-group="routine">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Alcohol Overage (Returning to Halifax) <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <p style="margin-bottom:12px;"><strong>Bringing alcohol back to Halifax:</strong></p>
      <ul style="margin-bottom:12px;">
        <li>All containers (bottles/cans/etc.) must remain sealed</li>
        <li>Immediately upon return to ship, securely package containers</li>
        <li>Deliver to Exchange Manager: Lt(N) Sexton</li>
        <li>If Exchange Manager absent: deliver to Duty PO who will log purchases and secure them in Coxn's Office until delivery for safe stowage</li>
      </ul>
    </div>
  </div>
</div>

<!-- ===== EXPLORE HUB ===== -->

<div id="explore" class="page">
  <button class="back-btn" onclick="nav('landing')">Home</button>
  <div class="page-title">Explore Halifax</div>
  <div class="page-subtitle">Get around, get out, get fed</div>
  <div class="color-bar"></div>
  <div class="landing-grid">
    <button class="landing-btn lb-map" onclick="nav('map')">
      <span class="icon-wrap">üó∫Ô∏è</span>
      <span>Map &amp; Getting Around</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
    <button class="landing-btn lb-todo" onclick="nav('todo')">
      <span class="icon-wrap">üéØ</span>
      <span>Things To Do</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
    <button class="landing-btn lb-food" onclick="nav('food')">
      <span class="icon-wrap">üçΩÔ∏è</span>
      <span>Food, Coffee &amp; Bars</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
  </div>
</div>

<!-- ===== WEATHER ===== -->

<div id="weather" class="page">
  <button class="back-btn" onclick="nav('landing')">Home</button>
  <div class="page-title">Weather</div>
  <div class="page-subtitle">Halifax ¬∑ Live updates</div>
  <div class="color-bar"></div>

  <div class="section-header">Current Conditions</div>
  <div class="card weather-current">
    <div id="weather-current">
      <div class="weather-empty">Loading current conditions‚Ä¶</div>
    </div>
  </div>

  <div id="weather-status" class="weather-status" aria-live="polite"></div>

  <div class="section-header">4-Day Forecast</div>
  <div id="weather-forecast" class="weather-grid">
    <div class="card weather-empty">Loading forecast‚Ä¶</div>
  </div>

  <div class="section-header">What to Expect</div>
  <div class="card" style="margin-bottom:16px;">
    <div class="card-note" style="color:var(--text-mid);line-height:1.7;margin-bottom:0;">
      Expect daytime highs around <strong>2¬∞ to 6¬∞C</strong> and overnight lows near <strong>-4¬∞ to -1¬∞C</strong>. March in Halifax swings between rain and wet snow, with frequent wind off the harbour. Pack a waterproof shell, warm mid-layer, and footwear with grip for slush or black ice. Weather changes quickly on the Atlantic ‚Äî always check a live forecast.
    </div>
  </div>

  <div class="section-header">Live Forecast Links</div>
  <div class="map-btns">
    <a class="map-btn" href="https://weather.gc.ca/en/location/index.html?coords=44.649,-63.575" target="_blank" rel="noopener">
      <span class="map-pin" style="background:linear-gradient(135deg,var(--royal-blue),var(--navy-gold));">üçÅ</span> Environment Canada <span class="chevron">‚Ä∫</span>
    </a>
    <a class="map-btn" href="https://www.accuweather.com/en/ca/halifax/b3k/weather-forecast/55489" target="_blank" rel="noopener">
      <span class="map-pin" style="background:linear-gradient(135deg,var(--royal-blue-light),var(--bright-gold));">üå°Ô∏è</span> AccuWeather <span class="chevron">‚Ä∫</span>
    </a>
    <a class="map-btn" href="https://www.timeanddate.com/weather/canada/halifax/ext" target="_blank" rel="noopener">
      <span class="map-pin" style="background:linear-gradient(135deg,var(--navy-gold),var(--royal-blue-light));">üìÖ</span> 14-Day Forecast <span class="chevron">‚Ä∫</span>
    </a>
    <a class="map-btn" href="https://www.canada.ca/en/environment-climate-change/services/weather-general-tools-resources/radar-overview/radar-sites/atlantic.html" target="_blank" rel="noopener">
      <span class="map-pin" style="background:linear-gradient(135deg,var(--bright-gold),var(--royal-blue));">üì°</span> Weather Radar (Atlantic) <span class="chevron">‚Ä∫</span>
    </a>
  </div>
</div>

<!-- ===== PAGE 2: MAP & GETTING AROUND ===== -->

<div id="map" class="page">
  <button class="back-btn" onclick="nav('explore')">Explore</button>
  <div class="page-title">Map &amp; Getting Around</div>
  <div class="page-subtitle">Tap any destination for walking directions from the ship</div>
  <div class="color-bar"></div>

  <!-- Embedded Map Overview -->
  <div class="map-embed-wrap">
    <iframe src="https://www.google.com/maps?q=Halifax,+NS&output=embed" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" title="Map of Downtown Halifax"></iframe>
  </div>

  <!-- Popular Destinations (always visible) -->
  <div class="section-header">Popular Destinations</div>
  <div class="map-btns">
    <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Halifax+Waterfront+Boardwalk&travelmode=walking" target="_blank" rel="noopener">
      <span class="map-pin">üìç</span> <span class="map-btn-label">Waterfront Boardwalk</span> <span class="map-btn-dist">Steps</span><span class="chevron">‚Ä∫</span>
    </a>
    <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Maritime+Museum+of+the+Atlantic+Halifax&travelmode=walking" target="_blank" rel="noopener">
      <span class="map-pin">üö¢</span> <span class="map-btn-label">Maritime Museum of the Atlantic</span> <span class="map-btn-dist">450m</span><span class="chevron">‚Ä∫</span>
    </a>
    <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Halifax+Citadel+National+Historic+Site&travelmode=walking" target="_blank" rel="noopener">
      <span class="map-pin">üè∞</span> <span class="map-btn-label">Halifax Citadel</span> <span class="map-btn-dist">1.2 km</span><span class="chevron">‚Ä∫</span>
    </a>
    <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Canadian+Museum+of+Immigration+at+Pier+21&travelmode=walking" target="_blank" rel="noopener">
      <span class="map-pin">üß≠</span> <span class="map-btn-label">Pier 21 (Immigration Museum)</span> <span class="map-btn-dist">400m</span><span class="chevron">‚Ä∫</span>
    </a>
    <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Halifax+Public+Gardens&travelmode=walking" target="_blank" rel="noopener">
      <span class="map-pin">üåø</span> <span class="map-btn-label">Public Gardens</span> <span class="map-btn-dist">1.3 km</span><span class="chevron">‚Ä∫</span>
    </a>
  </div>

  <!-- Restaurants & Bars (collapsible) -->
  <div class="map-section open" data-map-group="map-nav">
    <button class="map-section-trigger" onclick="toggleMapSection(this)">
      <span class="map-section-icon" style="background:var(--coral-soft);color:var(--coral);">üçΩÔ∏è</span>
      <span>Restaurants &amp; Bars</span>
      <span class="map-section-count">8 places</span>
      <span class="map-section-chevron">‚Ä∫</span>
    </button>
    <div class="map-section-body">
      <div class="map-btns">
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=The+Bicycle+Thief+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üçù</span> <span class="map-btn-label">The Bicycle Thief</span> <span class="map-btn-dist">300m</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Bar+Kismet+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">ü¶™</span> <span class="map-btn-label">Bar Kismet</span> <span class="map-btn-dist">1.0 km</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Lot+Six+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üç∏</span> <span class="map-btn-label">Lot Six</span> <span class="map-btn-dist">900m</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=The+Lower+Deck+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üé∂</span> <span class="map-btn-label">The Lower Deck</span> <span class="map-btn-dist">600m</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Durty+Nelly's+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üç∫</span> <span class="map-btn-label">Durty Nelly's</span> <span class="map-btn-dist">850m</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Bar+Stillwell+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üçª</span> <span class="map-btn-label">Stillwell Beer Bar</span> <span class="map-btn-dist">750m</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Pickford+%26+Black+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üåä</span> <span class="map-btn-label">Pickford &amp; Black</span> <span class="map-btn-dist">300m</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Gahan+House+Nova+Centre+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üç∫</span> <span class="map-btn-label">Gahan House</span> <span class="map-btn-dist">850m</span><span class="chevron">‚Ä∫</span>
        </a>
      </div>
    </div>
  </div>

  <!-- Attractions & Activities (collapsible) -->
  <div class="map-section" data-map-group="map-nav">
    <button class="map-section-trigger" onclick="toggleMapSection(this)">
      <span class="map-section-icon" style="background:var(--gold-soft);color:var(--gold);">üéØ</span>
      <span>Attractions &amp; Activities</span>
      <span class="map-section-count">6 places</span>
      <span class="map-section-chevron">‚Ä∫</span>
    </button>
    <div class="map-section-body">
      <div class="map-btns">
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Halifax+Citadel+National+Historic+Site&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üè∞</span> <span class="map-btn-label">Halifax Citadel</span> <span class="map-btn-dist">1.2 km</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Maritime+Museum+of+the+Atlantic+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">‚öì</span> <span class="map-btn-label">Maritime Museum</span> <span class="map-btn-dist">450m</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Point+Pleasant+Park&travelmode=driving" target="_blank" rel="noopener">
          <span class="map-pin">üå≤</span> <span class="map-btn-label">Point Pleasant Park</span> <span class="map-btn-dist">Drive</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Halifax+Public+Gardens&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üåø</span> <span class="map-btn-label">Public Gardens</span> <span class="map-btn-dist">1.3 km</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=HMCS+Sackville+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üö¢</span> <span class="map-btn-label">HMCS Sackville</span> <span class="map-btn-dist">500m</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Canadian+Museum+of+Immigration+at+Pier+21&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üß≠</span> <span class="map-btn-label">Pier 21 Museum</span> <span class="map-btn-dist">400m</span><span class="chevron">‚Ä∫</span>
        </a>
      </div>
    </div>
  </div>

  <!-- Historic Sites & Landmarks (collapsible, collapsed by default) -->
  <div class="map-section" data-map-group="map-nav">
    <button class="map-section-trigger" onclick="toggleMapSection(this)">
      <span class="map-section-icon" style="background:var(--plum-soft);color:var(--plum);">üèõÔ∏è</span>
      <span>Historic Sites &amp; Landmarks</span>
      <span class="map-section-count">9 places</span>
      <span class="map-section-chevron">‚Ä∫</span>
    </button>
    <div class="map-section-body">
      <div class="map-btns">
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Old+Town+Clock+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üï∞Ô∏è</span> <span class="map-btn-label">Old Town Clock</span> <span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Province+House+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">‚öñÔ∏è</span> <span class="map-btn-label">Province House</span> <span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=St.+Paul's+Church+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">‚õ™</span> <span class="map-btn-label">St. Paul's Church</span> <span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Art+Gallery+of+Nova+Scotia&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üé®</span> <span class="map-btn-label">Art Gallery of NS</span> <span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Hydrostone+Market+Halifax&travelmode=driving" target="_blank" rel="noopener">
          <span class="map-pin">üõçÔ∏è</span> <span class="map-btn-label">Hydrostone Market</span> <span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Fort+Needham+Memorial+Park+Halifax&travelmode=driving" target="_blank" rel="noopener">
          <span class="map-pin">üïäÔ∏è</span> <span class="map-btn-label">Fort Needham Memorial Park</span> <span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Africville+Museum+Halifax&travelmode=driving" target="_blank" rel="noopener">
          <span class="map-pin">üèõÔ∏è</span> <span class="map-btn-label">Africville Museum</span> <span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=York+Redoubt+National+Historic+Site&travelmode=driving" target="_blank" rel="noopener">
          <span class="map-pin">ü™ñ</span> <span class="map-btn-label">York Redoubt</span> <span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Georges+Island+National+Historic+Site+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin">üèùÔ∏è</span> <span class="map-btn-label">Georges Island Ferry</span> <span class="chevron">‚Ä∫</span>
        </a>
      </div>
    </div>
  </div>

  <!-- Essential Services (collapsible) -->
  <div class="map-section" data-map-group="map-nav">
    <button class="map-section-trigger" onclick="toggleMapSection(this)">
      <span class="map-section-icon" style="background:var(--coral-soft);color:var(--coral);">üè•</span>
      <span>Essential Services</span>
      <span class="map-section-count">3 places</span>
      <span class="map-section-chevron">‚Ä∫</span>
    </button>
    <div class="map-section-body">
      <div class="map-btns">
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=QEII+Health+Sciences+Centre+Halifax+Infirmary&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin" style="background:linear-gradient(135deg,var(--coral),#ff4757);">üè•</span> <span class="map-btn-label">QEII Halifax Infirmary</span> <span class="map-btn-dist">1.6 km</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=QEII+Victoria+General+Halifax&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin" style="background:linear-gradient(135deg,var(--coral),#ff4757);">üè•</span> <span class="map-btn-label">QEII VG Site</span> <span class="map-btn-dist">2.0 km</span><span class="chevron">‚Ä∫</span>
        </a>
        <a class="map-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Halifax+Regional+Police+Headquarters&travelmode=walking" target="_blank" rel="noopener">
          <span class="map-pin" style="background:linear-gradient(135deg,var(--royal-blue),var(--royal-blue-light));">üëÆ</span> <span class="map-btn-label">Halifax Regional Police HQ</span> <span class="chevron">‚Ä∫</span>
        </a>
      </div>
    </div>
  </div>

  <!-- Transportation Section -->
  <div class="section-header" style="margin-top:28px;">Getting Around</div>

  <div class="transport-grid">
    <a class="transport-card" href="https://www.uber.com" target="_blank" rel="noopener">
      <div class="transport-card-icon">üöó</div>
      <div class="transport-card-name">Uber</div>
      <div class="transport-card-sub">Reliable across HRM</div>
    </a>
    <a class="transport-card" href="https://www.halifax.ca/transportation/halifax-transit" target="_blank" rel="noopener">
      <div class="transport-card-icon">üöå</div>
      <div class="transport-card-name">Halifax Transit</div>
      <div class="transport-card-sub">Buses + ferry ‚Äî use HFX GO app</div>
    </a>
  </div>

  <div class="card" style="margin-bottom:14px;">
    <div class="card-note" style="color:var(--text-mid);line-height:1.7;margin-bottom:0;">
      The waterfront and downtown are flat and walkable. Citadel Hill is uphill; grab a rideshare if you're short on time. Halifax Transit buses and ferries take cash or e-tickets (HFX GO). Route 320 connects downtown to the airport if needed.
    </div>
  </div>

  <div class="section-header">Taxi Companies</div>
  <div class="taxi-list">
    <div class="taxi-item">
      <div class="taxi-info">
        <div class="taxi-name">Casino Taxi</div>
        <div class="taxi-sub">24/7 ‚Äî long-running local fleet</div>
      </div>
      <a href="tel:+19024296666" class="btn-sm btn-call">üìû (902) 429-6666</a>
    </div>
    <div class="taxi-item">
      <div class="taxi-info">
        <div class="taxi-name">Yellow Cab</div>
        <div class="taxi-sub">24/7 ‚Äî downtown specialist</div>
      </div>
      <a href="tel:+19024200000" class="btn-sm btn-call">üìû (902) 420-0000</a>
    </div>
    <div class="taxi-item">
      <div class="taxi-info">
        <div class="taxi-name">Bob's Taxi</div>
        <div class="taxi-sub">24/7 ‚Äî Dartmouth &amp; downtown</div>
      </div>
      <a href="tel:+19024632222" class="btn-sm btn-call">üìû (902) 463-2222</a>
    </div>
    <div class="taxi-item">
      <div class="taxi-info">
        <div class="taxi-name">Blue Bell Taxi</div>
        <div class="taxi-sub">24/7 ‚Äî bookings by phone</div>
      </div>
      <a href="tel:+19024446888" class="btn-sm btn-call">üìû (902) 444-6888</a>
    </div>
  </div>

  <!-- Fun Facts -->
  <div class="accordion-item" style="margin-top:22px;">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Fun Facts / Local Context <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <ul>
        <li>Halifax was founded in 1749 as a British naval base; the noon gun still fires daily from Citadel Hill.</li>
        <li>One of the world‚Äôs largest natural, ice-free harbours ‚Äî deep enough for naval and cruise ships year-round.</li>
        <li>Pier 21 processed over one million immigrants between 1928 and 1971.</li>
        <li>HMCS Sackville, berthed on the waterfront, is Canada‚Äôs Naval Memorial.</li>
        <li>The Public Gardens opened in 1867 and remain one of North America‚Äôs finest Victorian gardens.</li>
        <li>The harbour ferries to Dartmouth are among the oldest saltwater commuter ferries in North America.</li>
      </ul>
    </div>
  </div>
</div>

<!-- ===== PAGE 3: THINGS TO DO ===== -->

<div id="todo" class="page">
  <button class="back-btn" onclick="nav('explore')">Explore</button>
  <div class="page-title">Things To Do</div>
  <div class="page-subtitle">Filter by what you're feeling</div>
  <div class="color-bar"></div>

  <div class="chips" id="todo-chips"></div>
  <div id="todo-list"></div>
  <div id="todo-empty" class="empty-state" aria-live="polite" hidden>No activities match those filters yet. Try removing a chip.</div>
</div>

<!-- ===== PAGE 4: FOOD, COFFEE & BARS ===== -->

<div id="food" class="page">
  <button class="back-btn" onclick="nav('explore')">Explore</button>
  <div class="page-title">Food, Coffee &amp; Bars</div>
  <div class="page-subtitle">Verified local picks</div>
  <div class="color-bar"></div>

  <div class="tabs" role="tablist" aria-label="Food, coffee, and bar categories">
    <button class="tab active" role="tab" aria-selected="true" aria-controls="tab-food" id="tab-btn-food" onclick="switchTab('food','tab-food',this)">üç¥ Food</button>
    <button class="tab" role="tab" aria-selected="false" aria-controls="tab-coffee" id="tab-btn-coffee" onclick="switchTab('food','tab-coffee',this)">‚òï Coffee</button>
    <button class="tab" role="tab" aria-selected="false" aria-controls="tab-bars" id="tab-btn-bars" onclick="switchTab('food','tab-bars',this)">üç∫ Bars</button>
    <button class="tab" role="tab" aria-selected="false" aria-controls="tab-brew" id="tab-btn-brew" onclick="switchTab('food','tab-brew',this)">üçª Brew</button>
  </div>

  <div id="tab-food" class="tab-panel active" role="tabpanel" aria-labelledby="tab-btn-food">
    <input type="text" class="search-input" placeholder="Search restaurants‚Ä¶" oninput="filterVenues('tab-food',this.value)">
    <div class="venue-list"></div>
    <div class="empty-state" aria-live="polite" hidden>No matches in food &amp; dining. Try a different search.</div>
  </div>
  <div id="tab-coffee" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-coffee">
    <input type="text" class="search-input" placeholder="Search coffee shops‚Ä¶" oninput="filterVenues('tab-coffee',this.value)">
    <div class="venue-list"></div>
    <div class="empty-state" aria-live="polite" hidden>No matches in coffee &amp; bakeries. Try a different search.</div>
  </div>
  <div id="tab-bars" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-bars">
    <input type="text" class="search-input" placeholder="Search bars‚Ä¶" oninput="filterVenues('tab-bars',this.value)">
    <div class="venue-list"></div>
    <div class="empty-state" aria-live="polite" hidden>No matches in bars &amp; pubs. Try a different search.</div>
  </div>
  <div id="tab-brew" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-brew">
    <input type="text" class="search-input" placeholder="Search breweries‚Ä¶" oninput="filterVenues('tab-brew',this.value)">
    <div class="venue-list"></div>
    <div class="empty-state" aria-live="polite" hidden>No matches in breweries. Try a different search.</div>
  </div>
</div>

<!-- ===== PAGE 5: HOTELS ===== -->

<div id="hotels" class="page">
  <button class="back-btn" onclick="nav('landing')">Home</button>
  <div class="page-title">Hotels</div>
  <div class="page-subtitle">Downtown Halifax area</div>
  <div class="color-bar"></div>
  <input type="text" class="search-input" placeholder="Search hotels‚Ä¶" oninput="filterHotels(this.value)">
  <div id="hotel-list"></div>
  <div id="hotel-empty" class="empty-state" aria-live="polite" hidden>No hotels match that search yet.</div>
</div>

<!-- ===== PAGE 6: SAFETY ===== -->

<div id="safety" class="page">
  <button class="back-btn" onclick="nav('landing')">Home</button>
  <div class="page-title">Safety</div>
  <div class="page-subtitle">Stay sharp, stay safe</div>
  <div class="color-bar"></div>

<a href="tel:911" class="emergency-box">üö®&nbsp; Emergency: 911  &rarr;</a>

  <div class="accordion-item" data-group="safety">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">General <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <ul>
        <li>Overall crime rates are moderate; downtown and the waterfront are well-patrolled.</li>
        <li>Pickpocketing is uncommon but use awareness in busy bar areas.</li>
        <li>Halifax is generally safe ‚Äî use common sense and stay aware.</li>
        <li><strong>Travel in pairs/groups</strong> ‚Äî buddy system in full effect</li>
        <li>Stick to well-lit, populated areas at night ‚Äî <strong>do not travel on unlit streets</strong></li>
        <li>Stay on main roadways</li>
        <li>Do not engage in political arguments with locals</li>
        <li>March weather swings between rain and snow: layer, waterproof, and watch for ice</li>
        <li>Photograph/photocopy front and back of credit cards (helps with cancellation if lost/stolen)</li>
        <li><strong>Do not take passport ashore</strong></li>
      </ul>
    </div>
  </div>
  <div class="accordion-item" data-group="safety">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Health &amp; STDs <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <div style="background:rgba(255,107,107,0.15);border-left:3px solid var(--coral);padding:12px;border-radius:8px;margin-bottom:12px;">
        <p style="font-weight:800;color:var(--white);margin-bottom:6px;">‚ö†Ô∏è Important Health Information</p>
        <ul>
          <li>STD rates have spiked since 2023, as with all other provinces</li>
          <li>Practice safe behaviors and be cautious</li>
        </ul>
      </div>
    </div>
  </div>
  <div class="accordion-item" data-group="safety">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Alcohol / Nights Out <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <div style="background:rgba(255,107,107,0.15);border-left:3px solid var(--coral);padding:12px;border-radius:8px;margin-bottom:12px;">
        <p style="font-weight:800;color:var(--white);margin-bottom:6px;">üç∫ Alcohol Policy</p>
        <ul>
          <li><strong>Legal drinking age in Nova Scotia: 19</strong></li>
          <li><strong>No alcohol 8 hrs before duty/work</strong></li>
          <li><strong>Do not be intoxicated ashore</strong> ‚Äî QMs will police this at the Brow</li>
          <li>Bar hours per Daily Routine; extensions will not be considered prior to working days in port</li>
        </ul>
      </div>
      <p style="margin-bottom:8px;font-weight:700;color:var(--white);">Nights Out:</p>
      <ul>
        <li>Argyle Street and the waterfront boardwalk are the main strips ‚Äî pace yourself</li>
        <li>Arrange your ride back before going out</li>
        <li>Look out for your shipmates</li>
        <li>Bars close at 2 AM on weekends</li>
      </ul>
    </div>
  </div>
  <div class="accordion-item" data-group="safety">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">ID / Valuables <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <ul>
        <li>Carry military ID and a second piece of government photo ID.</li>
        <li>Don't carry more cash than you need.</li>
        <li>Leave valuables secured aboard or in your hotel safe.</li>
      </ul>
    </div>
  </div>
  <div class="accordion-item" data-group="safety">
    <button class="accordion-trigger" onclick="toggleAccordion(this)">Emergencies <span class="accordion-icon">+</span></button>
    <div class="accordion-body">
      <ul>
        <li>Call <strong>911</strong> for police, fire, or ambulance.</li>
        <li>Nearest hospital: QEII Halifax Infirmary, 1796 Summer St.</li>
        <li>Non-emergency police: Halifax Regional Police.</li>
        <li>Inform the ship of any incidents as soon as practical.</li>
      </ul>
    </div>
  </div>
</div>

<!-- ===== PAGE 7: CONTACTS ===== -->

<div id="contacts" class="page">
  <button class="back-btn" onclick="nav('landing')">Home</button>
  <div class="page-title">Contacts</div>
  <div class="page-subtitle">Quick access</div>
  <div class="color-bar"></div>
  <div class="landing-grid">
    <button class="landing-btn lb-routine" onclick="nav('contacts-ship')">
      <span class="icon-wrap">‚öì</span>
      <span>Ship Contacts</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
    <button class="landing-btn lb-map" onclick="nav('contacts-local')">
      <span class="icon-wrap">üìç</span>
      <span>Local Contacts</span>
      <span class="btn-arrow">‚Ä∫</span>
    </button>
  </div>
</div>

<!-- SHIP CONTACTS -->

<div id="contacts-ship" class="page">
  <button class="back-btn" onclick="nav('contacts')">Contacts</button>
  <div class="page-title">Ship Contacts</div>
  <div class="page-subtitle">Placeholder numbers ‚Äî update before sailing</div>
  <div class="color-bar"></div>

  <div class="contact-card">
    <div class="contact-label">Brow</div>
    <div class="contact-sub">+1-555-0100 (placeholder)</div>
    <div class="contact-actions">
      <span class="btn-sm btn-disabled" style="opacity:0.5;cursor:not-allowed;">üìû Call</span>
      <span class="btn-sm btn-disabled" style="opacity:0.5;cursor:not-allowed;">üí¨ Text</span>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">Cox'n</div>
    <div class="contact-sub">+1-555-0101 (placeholder)</div>
    <div class="contact-actions">
      <span class="btn-sm btn-disabled" style="opacity:0.5;cursor:not-allowed;">üìû Call</span>
      <span class="btn-sm btn-disabled" style="opacity:0.5;cursor:not-allowed;">üí¨ Text</span>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">XO</div>
    <div class="contact-sub">+1-555-0102 (placeholder)</div>
    <div class="contact-actions">
      <span class="btn-sm btn-disabled" style="opacity:0.5;cursor:not-allowed;">üìû Call</span>
      <span class="btn-sm btn-disabled" style="opacity:0.5;cursor:not-allowed;">üí¨ Text</span>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">Duty Medical</div>
    <div class="contact-sub">+1-555-0103 (placeholder)</div>
    <div class="contact-actions">
      <span class="btn-sm btn-disabled" style="opacity:0.5;cursor:not-allowed;">üìû Call</span>
      <span class="btn-sm btn-disabled" style="opacity:0.5;cursor:not-allowed;">üí¨ Text</span>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">Port Liaison Officer</div>
    <div class="contact-sub">SLt Prosser</div>
    <div class="contact-actions">
      <span style="font-size:0.84rem;color:var(--text-mid);">Contact via Brow/Command Team</span>
    </div>
  </div>
</div>

<!-- LOCAL CONTACTS -->

<div id="contacts-local" class="page">
  <button class="back-btn" onclick="nav('contacts')">Contacts</button>
  <div class="page-title">Local Contacts</div>
  <div class="page-subtitle">Halifax, NS</div>
  <div class="color-bar"></div>

<a href="tel:911" class="emergency-box">üö®&nbsp; Emergency: 911  &rarr;</a>

  <div class="contact-card">
    <div class="contact-label">QEII Health Sciences Centre</div>
    <div class="contact-sub">1796 Summer St, Halifax, NS</div>
    <div class="contact-actions">
      <a href="tel:+19024732700" class="btn-sm btn-call">üìû Call</a>
      <a href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=QEII+Health+Sciences+Centre+Halifax+Infirmary&travelmode=walking" target="_blank" rel="noopener" class="btn-sm btn-map">üö∂ Walk</a>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">Police (Non-Emergency)</div>
    <div class="contact-sub">Halifax Regional Police</div>
    <div class="contact-actions">
      <a href="tel:+19024905020" class="btn-sm btn-call">üìû Call</a>
      <a href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=Halifax+Regional+Police+Headquarters&travelmode=walking" target="_blank" rel="noopener" class="btn-sm btn-map">üö∂ Walk</a>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">Mental Health Crisis Line</div>
    <div class="contact-sub">Nova Scotia 24/7 Crisis Support</div>
    <div class="contact-actions">
      <a href="tel:+18884298167" class="btn-sm btn-call">üìû 1-888-429-8167</a>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">Poison Control</div>
    <div class="contact-sub">Atlantic Canada Poison Centre</div>
    <div class="contact-actions">
      <a href="tel:+18447647669" class="btn-sm btn-call">üìû 1-844-764-7669</a>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">Canadian Coast Guard</div>
    <div class="contact-sub">Marine emergencies</div>
    <div class="contact-actions">
      <a href="tel:+18002670780" class="btn-sm btn-call">üìû 1-800-267-0780</a>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">Casino Taxi</div>
    <div class="contact-sub">24/7 cab service</div>
    <div class="contact-actions">
      <a href="tel:+19024296666" class="btn-sm btn-call">üìû (902) 429-6666</a>
    </div>
  </div>
  <div class="contact-card">
    <div class="contact-label">Yellow Cab</div>
    <div class="contact-sub">24/7 cab service</div>
    <div class="contact-actions">
      <a href="tel:+19024200000" class="btn-sm btn-call">üìû (902) 420-0000</a>
    </div>
  </div>
</div>

<!-- ===== PAGE 8: CROW'S NEST ===== -->

<div id="crowsnest" class="page">
  <button class="back-btn" onclick="nav('landing')">Home</button>

  <!-- HERO -->
  <div class="cn-hero">
    <div class="cn-hero-badge">Canada's Naval Memorial</div>
    <div class="cn-hero-title">HMCS Sackville</div>
    <div class="cn-hero-est">Flower-class Corvette &middot; Launched 1941</div>
    <div class="cn-hero-designation">1675 Lower Water Street, Halifax, Nova Scotia</div>
  </div>

  <div class="cn-divider"></div>

  <!-- INTRO QUOTE -->
  <div class="cn-intro">
    <p>Moored on the Halifax waterfront beside the Maritime Museum of the Atlantic, HMCS <em>Sackville</em> is the last surviving Flower-class corvette in the world. Maintained by the Canadian Naval Memorial Trust, she honours the sailors and merchant mariners who fought the Battle of the Atlantic. Visitors can step aboard the restored ship and experience the cramped messdecks and bridge that carried crews through the North Atlantic.</p>
    <span class="cn-intro-source">&mdash; Canadian Naval Memorial Trust</span>
  </div>

  <!-- AT A GLANCE -->
  <div class="cn-glance">
    <div class="cn-glance-title">At a Glance</div>
    <div class="cn-glance-grid">
      <div class="cn-glance-item">
        <span class="cn-glance-icon">&#9875;</span>
        <div class="cn-glance-label">Founded</div>
        <div class="cn-glance-value">Commissioned 1941</div>
      </div>
      <div class="cn-glance-item">
        <span class="cn-glance-icon">&#127987;</span>
        <div class="cn-glance-label">Designation</div>
        <div class="cn-glance-value">Canada's Naval Memorial (1985)</div>
      </div>
      <div class="cn-glance-item">
        <span class="cn-glance-icon">&#128506;</span>
        <div class="cn-glance-label">Ship Type</div>
        <div class="cn-glance-value">Flower-class Corvette</div>
      </div>
      <div class="cn-glance-item">
        <span class="cn-glance-icon">&#128270;</span>
        <div class="cn-glance-label">Signature Artefact</div>
        <div class="cn-glance-value">Wartime crew of ~85</div>
      </div>
    </div>
  </div>

  <div class="cn-divider-ornament">Chapter I</div>

  <!-- SECTION 1: ORIGINS -->
  <div class="cn-section">
    <div class="cn-section-header">
      <div class="cn-section-number">I</div>
      <div>
        <div class="cn-section-title">Design &amp; Build</div>
        <div class="cn-section-subtitle">A small escort for a big ocean</div>
      </div>
    </div>
    <p>Built at Saint John Shipbuilding and launched in May 1941, <em>Sackville</em> was one of 123 corvettes constructed for the Royal Canadian Navy. These compact escorts could be produced quickly in civilian yards, giving Canada the numbers needed to protect convoys from U-boats.</p>
    <p>At just over 205 feet long with a single propeller and a top speed of 16 knots, Flower-class corvettes were wet, cramped, and demanding to sail. Yet their shallow draft and tight turning circle made them invaluable in the harsh North Atlantic.</p>
    <div class="cn-section-img">
      <img src="IMG_0524.jpeg" alt="Historic naval artifacts and memorabilia.">
      <div class="cn-section-img-caption">Restored spaces showcase the equipment and atmosphere of wartime corvettes</div>
    </div>
  </div>

  <div class="cn-divider-ornament">Chapter II</div>

  <!-- SECTION 2: WAR YEARS -->
  <div class="cn-section">
    <div class="cn-section-header">
      <div class="cn-section-number">II</div>
      <div>
        <div class="cn-section-title">Battle of the Atlantic</div>
        <div class="cn-section-subtitle">1941 &ndash; 1945</div>
      </div>
    </div>
    <p><em>Sackville</em> escorted convoys from Halifax and St. John's into the North Atlantic, enduring brutal weather and constant submarine threats. In August 1942 she fought through heavy seas to depth-charge a U-boat contact, one of several close engagements during her wartime service.</p>
    <p>Like most corvettes, she rolled heavily and was often soaked by green water, but her crew kept steaming. After a major refit in 1944, <em>Sackville</em> returned to duty with improved habitability and anti-submarine gear, serving until the war's end.</p>
    <div class="cn-section-img">
      <img src="IMG_0525.jpeg" alt="Heritage naval artifacts and seating.">
      <div class="cn-section-img-caption">Interpretive displays explain life aboard a corvette on North Atlantic escort duty</div>
    </div>
  </div>

  <!-- MID-PAGE QUOTE -->
  <div class="cn-callout">
    <div class="cn-callout-text">&ldquo;A living memorial to those who braved the North Atlantic in small ships.&rdquo;</div>
    <div class="cn-callout-attr">&mdash; Canadian Naval Memorial Trust</div>
  </div>

  <div class="cn-divider-ornament">Chapter III</div>

  <!-- SECTION 3: U-BOAT PERISCOPE -->
  <div class="cn-section">
    <div class="cn-section-header">
      <div class="cn-section-number">III</div>
      <div>
        <div class="cn-section-title">From Workhorse to Memorial</div>
        <div class="cn-section-subtitle">A second life in Halifax</div>
      </div>
    </div>
    <p>Paid off in 1946, <em>Sackville</em> later served as a civilian research vessel. In the 1980s she was transferred to the Canadian Naval Memorial Trust, whose volunteers and veterans restored her to a 1944 wartime fit with original machinery and fittings.</p>
    <p>Today she is berthed in Halifax each summer (and moved under cover in winter), hosting public tours, commemorations, and naval ceremonies.</p>
    <div class="cn-section-img">
      <img src="IMG_0526.jpeg" alt="Naval artifacts and memorabilia aboard a corvette.">
      <div class="cn-section-img-caption">Restoration work keeps original equipment and living spaces intact</div>
    </div>
  </div>

  <div class="cn-divider-ornament">Chapter IV</div>

  <!-- SECTION 4: AFTER THE WAR -->
  <div class="cn-section">
    <div class="cn-section-header">
      <div class="cn-section-number">IV</div>
      <div>
        <div class="cn-section-title">Visiting Today</div>
        <div class="cn-section-subtitle">A hands-on history lesson</div>
      </div>
    </div>
    <p>Guides and volunteers are happy to explain the engine room, messes, and bridge layout. The restored spaces make it easy to picture watch rotations, cramped bunks, and the long nights on the North Atlantic.</p>
    <p>Donations support ongoing maintenance and the memory of those lost in the Battle of the Atlantic.</p>
    <div class="cn-section-img">
      <img src="IMG_0527.jpeg" alt="Upper deck of a preserved naval vessel.">
      <div class="cn-section-img-caption">Upper deck fittings and bridge equipment remain largely original</div>
    </div>
  </div>

  <div class="cn-divider"></div>

  <!-- PHOTO GALLERY -->
  <div class="cn-gallery">
    <div class="cn-gallery-title">Gallery</div>
    <div class="cn-gallery-strip">
      <div class="cn-gallery-item">
        <img src="IMG_0524.jpeg" alt="Wartime memorabilia on the walls">
        <div class="cn-gallery-item-caption">Wartime memorabilia and naval heritage displays</div>
      </div>
      <div class="cn-gallery-item">
        <img src="IMG_0525.jpeg" alt="Heritage artifacts and seating">
        <div class="cn-gallery-item-caption">Period furnishings illustrate life aboard a corvette</div>
      </div>
      <div class="cn-gallery-item">
        <img src="IMG_0526.jpeg" alt="Artifacts and memorabilia">
        <div class="cn-gallery-item-caption">Restored equipment and artifacts from Atlantic convoys</div>
      </div>
      <div class="cn-gallery-item">
        <img src="IMG_0527.jpeg" alt="Upper deck view">
        <div class="cn-gallery-item-caption">Upper deck details and bridge view</div>
      </div>
      <div class="cn-gallery-item">
        <img src="IMG_0528.jpeg" alt="Interior wartime displays">
        <div class="cn-gallery-item-caption">Wartime displays and messdeck layouts</div>
      </div>
    </div>
  </div>

  <div class="cn-divider"></div>

  <!-- TIMELINE -->
  <div class="cn-timeline">
    <div class="cn-timeline-title">Timeline</div>
    <ul class="cn-timeline-list">
      <li class="cn-timeline-item">
        <div class="cn-timeline-year">15 May 1941</div>
        <div class="cn-timeline-text">Launched at Saint John Shipbuilding as part of Canada's corvette program.</div>
      </li>
      <li class="cn-timeline-item cn-tl-highlight">
        <div class="cn-timeline-year">Dec 1941</div>
        <div class="cn-timeline-text">Commissioned into the Royal Canadian Navy as HMCS <em>Sackville</em>.</div>
      </li>
      <li class="cn-timeline-item">
        <div class="cn-timeline-year">1942 &ndash; 1944</div>
        <div class="cn-timeline-text">Escorts North Atlantic convoys from Halifax and St. John's during the Battle of the Atlantic.</div>
      </li>
      <li class="cn-timeline-item">
        <div class="cn-timeline-year">1944</div>
        <div class="cn-timeline-text">Receives a major refit, improving stability, accommodation, and anti-submarine weapons.</div>
      </li>
      <li class="cn-timeline-item">
        <div class="cn-timeline-year">1946</div>
        <div class="cn-timeline-text">Paid off and later employed as a civilian research vessel.</div>
      </li>
      <li class="cn-timeline-item">
        <div class="cn-timeline-year">1983</div>
        <div class="cn-timeline-text">Transferred to the Canadian Naval Memorial Trust for preservation.</div>
      </li>
      <li class="cn-timeline-item cn-tl-highlight">
        <div class="cn-timeline-year">1985</div>
        <div class="cn-timeline-text">Commissioned as Canada's Naval Memorial.</div>
      </li>
      <li class="cn-timeline-item">
        <div class="cn-timeline-year">Present Day</div>
        <div class="cn-timeline-text">A living memorial on Halifax's waterfront honouring the Battle of the Atlantic.</div>
      </li>
    </ul>
  </div>

  <div class="cn-divider"></div>

  <!-- VISITING INFORMATION -->
  <div class="cn-visit">
    <div class="cn-visit-title">Plan Your Visit</div>

    <div class="cn-visit-row">
      <div class="cn-visit-icon">&#128205;</div>
      <div>
        <div class="cn-visit-label">Address</div>
        <div class="cn-visit-value">1675 Lower Water Street, Halifax, NS<br>Along the boardwalk beside the Maritime Museum of the Atlantic</div>
      </div>
    </div>

    <div class="cn-visit-row">
      <div class="cn-visit-icon">&#128336;</div>
      <div>
        <div class="cn-visit-label">Hours (subject to change)</div>
        <ul class="cn-visit-hours">
          <li><strong>Seasonal</strong> Typically May &ndash; October</li>
          <li><strong>Off-season</strong> Check website; group tours by appointment</li>
        </ul>
      </div>
    </div>

    <div class="cn-visit-row">
      <div class="cn-visit-icon">&#127860;</div>
      <div>
        <div class="cn-visit-label">Dining &amp; Capacity</div>
        <div class="cn-visit-value">Open-deck tours; small interior spaces &mdash; plan for staggered entry during busy times.</div>
      </div>
    </div>

    <div class="cn-visit-row">
      <div class="cn-visit-icon">&#127894;</div>
      <div>
        <div class="cn-visit-label">Dress &amp; Admission</div>
        <div class="cn-visit-value">Casual dress. Donations encouraged to support upkeep of the memorial.</div>
      </div>
    </div>

    <div class="cn-visit-note">
      Operations are weather-dependent; confirm hours before heading down the pier, especially in winter/early spring.
    </div>
  </div>

  <!-- ACTION BUTTONS -->
  <div class="cn-actions">
    <a class="cn-action-btn" href="https://www.google.com/maps/dir/?api=1&origin=44.6465,-63.5729&destination=HMCS+Sackville+Halifax&travelmode=walking" target="_blank" rel="noopener">&#9898; Walking Directions</a>
    <a class="cn-action-btn" href="https://hmcssackville.ca/" target="_blank" rel="noopener">&#9875; Official Website</a>
  </div>
  <div class="cn-actions">
    <a class="cn-action-btn" href="https://hmcssackville.ca/about/" target="_blank" rel="noopener">&#127983; Naval Memorial Trust</a>
  </div>

  <!-- FOOTER -->
  <div class="cn-footer">
    <div class="cn-footer-text">&ldquo;We will remember them.&rdquo;<br>In honour of those who sailed the Battle of the Atlantic, 1939&ndash;1945</div>
  </div>
</div>

<button id="quick-home" class="quick-home" onclick="nav('landing')" aria-label="Back to home">üè† Home</button>

<script src="data.js"></script>
<script>
/* ===== HEADER SCROLL EFFECT ===== */
let lastScroll = 0;
window.addEventListener('scroll', () => {
  const header = document.querySelector('.header');
  const currentScroll = window.pageYOffset;
  if (currentScroll > 50) {
    header.classList.add('scrolled');
  } else {
    header.classList.remove('scrolled');
  }
  lastScroll = currentScroll;
});

/* ===== NAVIGATION ===== */
function syncHash(pageId) {
  const nextHash = pageId === 'landing' ? '' : `#${pageId}`;
  if (location.hash === nextHash) return;
  const nextUrl = `${location.pathname}${location.search}${nextHash}`;
  history.replaceState(null, '', nextUrl);
}

function nav(pageId) {
  const el = document.getElementById(pageId);
  if (!el || !el.classList.contains('page')) return;
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  el.classList.add('active');
  window.scrollTo({ top: 0, behavior: 'auto' });
  syncHash(pageId);
  updateQuickHome(pageId);
  if (pageId === 'weather') {
    loadWeather();
  }
}

/* ===== ACCORDION ===== */
function toggleAccordion(trigger) {
  const item = trigger.parentElement;
  const group = item.dataset.group;
  const isOpen = item.classList.contains('open');
  if (group) {
    document.querySelectorAll(`.accordion-item[data-group="${group}"]`).forEach(a => a.classList.remove('open'));
  }
  if (!isOpen) {
    item.classList.add('open');
  } else if (!group) {
    item.classList.remove('open');
  }
  const expanded = item.classList.contains('open');
  trigger.setAttribute('aria-expanded', expanded);
  const bodyId = trigger.getAttribute('aria-controls');
  if (bodyId) {
    const body = document.getElementById(bodyId);
    if (body) body.hidden = !expanded;
  }
}

/* ===== MAP SECTION TOGGLE ===== */
function toggleMapSection(trigger) {
  const section = trigger.parentElement;
  const isOpen = section.classList.contains('open');
  if (isOpen) {
    section.classList.remove('open');
  } else {
    section.classList.add('open');
  }
}

/* ===== THINGS TO DO ===== */
const { activities = [], todoChips = [], venueData = {}, hotelData = [] } = window.PORT_DATA || {};

// Validate that data.js loaded properly
if (!window.PORT_DATA) {
  console.error('PORT_DATA not loaded - data.js may have failed to load or has syntax errors');
}

let activeFilters = new Set();

// Ship location in Halifax (44.6465¬∞N, -63.5729¬∞W)
const SHIP_LOCATION = '44.6465,-63.5729';

// HTML escaping function to prevent XSS
function escapeHtml(str) {
  if (!str) return '';
  const div = document.createElement('div');
  div.textContent = str;
  return div.innerHTML;
}

function renderTodoChips() {
  if (!todoChips) return;
  document.getElementById('todo-chips').innerHTML = todoChips.map(c =>
    `<span class="chip${activeFilters.has(c)?' active':''}" onclick="toggleChip('${escapeHtml(c)}')">${escapeHtml(c)}</span>`
  ).join('');
}

function toggleChip(tag) {
  if (activeFilters.has(tag)) activeFilters.delete(tag); else activeFilters.add(tag);
  renderTodoChips(); renderTodoList();
}

function renderTodoList() {
  if (!activities) return;
  const filtered = activeFilters.size === 0 ? activities :
    activities.filter(a => a.tags && a.tags.some(t => activeFilters.has(t)));
  document.getElementById('todo-list').innerHTML = filtered.map(a => `
    <div class="card">
      <div class="card-name">${escapeHtml(a.name)}</div>
      <div class="card-note">${escapeHtml(a.desc)}</div>
      <div class="card-tags">${(a.tags || []).map(t => `<span class="card-tag">${escapeHtml(t)}</span>`).join('')}</div>
      <div class="card-actions">
        <a class="btn-sm btn-map" href="https://www.google.com/maps/dir/?api=1&origin=${SHIP_LOCATION}&destination=${encodeURIComponent(a.map)}&travelmode=walking" target="_blank" rel="noopener">üö∂ Walk</a>
        ${a.web ? `<a class="btn-sm btn-web" href="${escapeHtml(a.web)}" target="_blank" rel="noopener">üåê Website</a>` : ''}
      </div>
    </div>
  `).join('');
  const emptyEl = document.getElementById('todo-empty');
  if (emptyEl) emptyEl.hidden = filtered.length !== 0;
}
renderTodoChips(); renderTodoList();

/* ===== VENUE DATA ===== */
function renderVenues(tabId) {
  const panel = document.getElementById(tabId);
  const list = panel.querySelector('.venue-list');
  const data = venueData[tabId] || [];
  list.innerHTML = data.map((v, i) => `
    <div class="card venue-card" data-idx="${i}">
      <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
        <div class="card-name">${escapeHtml(v.name)}</div>
        ${v.price ? `<span class="price-badge">${escapeHtml(v.price)}</span>` : ''}
      </div>
      ${v.note ? `<div class="card-note">${escapeHtml(v.note)}</div>` : ''}
      <div class="card-actions">
        <a class="btn-sm btn-map" href="https://www.google.com/maps/dir/?api=1&origin=${SHIP_LOCATION}&destination=${encodeURIComponent(v.map)}&travelmode=walking" target="_blank" rel="noopener">üö∂ Walk</a>
        ${v.web ? `<a class="btn-sm btn-web" href="${escapeHtml(v.web)}" target="_blank" rel="noopener">üåê Website</a>` : ''}
      </div>
    </div>
  `).join('');
  const emptyEl = panel.querySelector('.empty-state');
  if (emptyEl) emptyEl.hidden = data.length !== 0;
}

function filterVenues(tabId, query) {
  const q = query.toLowerCase();
  const panel = document.getElementById(tabId);
  if (!venueData[tabId]) {
    const emptyEl = panel.querySelector('.empty-state');
    if (emptyEl) emptyEl.hidden = false;
    return;
  }
  let visibleCount = 0;
  panel.querySelectorAll('.venue-card').forEach((card, i) => {
    const v = venueData[tabId][i];
    const match = v.name.toLowerCase().includes(q) || (v.note && v.note.toLowerCase().includes(q)) || (v.price && v.price.toLowerCase().includes(q));
    card.style.display = match ? '' : 'none';
    if (match) visibleCount += 1;
  });
  const emptyEl = panel.querySelector('.empty-state');
  if (emptyEl) emptyEl.hidden = visibleCount !== 0;
}
Object.keys(venueData).forEach(renderVenues);

/* ===== TABS ===== */
function switchTab(pageId, tabId, btn) {
  const page = document.getElementById(pageId);
  page.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  page.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  page.querySelectorAll('.tab').forEach(t => t.setAttribute('aria-selected', 'false'));
  btn.classList.add('active');
  btn.setAttribute('aria-selected', 'true');
  document.getElementById(tabId).classList.add('active');
}

/* ===== HOTELS ===== */
function renderHotels() {
  document.getElementById('hotel-list').innerHTML = hotelData.map((h, i) => `
    <div class="card hotel-card" data-idx="${i}">
      <div class="card-name">${escapeHtml(h.name)}</div>
      ${h.note ? `<div class="card-note">${escapeHtml(h.note)}</div>` : ''}
      <div class="card-actions">
        <a class="btn-sm btn-map" href="https://www.google.com/maps/dir/?api=1&origin=${SHIP_LOCATION}&destination=${encodeURIComponent(h.map)}&travelmode=walking" target="_blank" rel="noopener">üö∂ Walk</a>
        ${h.web ? `<a class="btn-sm btn-web" href="${escapeHtml(h.web)}" target="_blank" rel="noopener">üåê Website</a>` : ''}
      </div>
    </div>
  `).join('');
  const emptyEl = document.getElementById('hotel-empty');
  if (emptyEl) emptyEl.hidden = hotelData.length !== 0;
}

function filterHotels(query) {
  const q = query.toLowerCase();
  let visibleCount = 0;
  document.querySelectorAll('.hotel-card').forEach((card, i) => {
    const h = hotelData[i];
    const match = (h.name.toLowerCase().includes(q) || (h.note && h.note.toLowerCase().includes(q)));
    card.style.display = match ? '' : 'none';
    if (match) visibleCount += 1;
  });
  const emptyEl = document.getElementById('hotel-empty');
  if (emptyEl) emptyEl.hidden = visibleCount !== 0;
}
renderHotels();

/* ===== ACCESSIBILITY BOOTSTRAP ===== */
document.querySelectorAll('.accordion-item').forEach((item, index) => {
  const trigger = item.querySelector('.accordion-trigger');
  const body = item.querySelector('.accordion-body');
  if (!trigger || !body) return;
  const bodyId = body.id || `accordion-body-${index + 1}`;
  body.id = bodyId;
  trigger.setAttribute('aria-controls', bodyId);
  trigger.setAttribute('aria-expanded', item.classList.contains('open'));
  body.hidden = !item.classList.contains('open');
});

/* ===== QUICK HOME ===== */
const quickHome = document.getElementById('quick-home');
function updateQuickHome(pageId) {
  if (!quickHome) return;
  if (pageId && pageId !== 'landing') {
    quickHome.classList.add('show');
  } else {
    quickHome.classList.remove('show');
  }
}

/* ===== HASH ROUTING ===== */
function checkHash() {
  const hash = location.hash.replace('#','');
  if (hash && document.getElementById(hash)) nav(hash);
}
window.addEventListener('hashchange', checkHash);
checkHash();
updateQuickHome(document.querySelector('.page.active')?.id || 'landing');

/* ===== WEATHER ===== */
const WEATHER_COORDS = { lat: 44.6488, lon: -63.5752 };
let weatherLoaded = false;

function formatTemp(value) {
  if (value === undefined || value === null || Number.isNaN(value)) return '--';
  return `${Math.round(value)}¬∞`;
}

function hasNumericValue(value) {
  return typeof value === 'number' && Number.isFinite(value);
}

function formatWindKmh(speedMps) {
  if (!hasNumericValue(speedMps)) return '‚Äî';
  return `${Math.round(speedMps * 3.6)} km/h`;
}

function formatPrecipMm(value) {
  if (!hasNumericValue(value)) return null;
  return `${value.toFixed(1)} mm`;
}

function formatDay(dateString) {
  const date = new Date(dateString);
  return date.toLocaleDateString('en-CA', { weekday: 'short', month: 'short', day: 'numeric' });
}

function getWindDirection(deg) {
  const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
  const index = Math.round(deg / 45) % 8;
  return directions[index];
}

function renderCurrentWeather(data) {
  const container = document.getElementById('weather-current');
  if (!container) return;
  const icon = data.weather?.[0]?.icon;
  const description = data.weather?.[0]?.description || '‚Äî';
  const temp = formatTemp(data.main?.temp);
  const feelsLike = formatTemp(data.main?.feels_like);
  const wind = formatWindKmh(data.wind?.speed);
  const windGust = hasNumericValue(data.wind?.gust) ? `${Math.round(data.wind.gust * 3.6)} km/h` : null;
  const windDir = data.wind?.deg !== undefined ? getWindDirection(data.wind.deg) : null;
  const humidity = hasNumericValue(data.main?.humidity) ? `${Math.round(data.main.humidity)}%` : '‚Äî';
  const rain = formatPrecipMm(data.rain?.['1h']);
  const snow = formatPrecipMm(data.snow?.['1h']);
  const iconUrl = icon ? `https://openweathermap.org/img/wn/${icon}@2x.png` : '';

  const windDisplay = windDir ? `${wind} ${windDir}` : wind;

  const additionalStats = [];
  if (windGust) additionalStats.push(`<div class="weather-stat"><div class="weather-stat-label">Gust</div><div class="weather-stat-value">${windGust}</div></div>`);
  if (rain) additionalStats.push(`<div class="weather-stat"><div class="weather-stat-label">Rain</div><div class="weather-stat-value">${rain}</div></div>`);
  if (snow) additionalStats.push(`<div class="weather-stat"><div class="weather-stat-label">Snow</div><div class="weather-stat-value">${snow}</div></div>`);

  container.innerHTML = `
    <div class="weather-current-top">
      <div class="weather-current-left">
        ${iconUrl ? `<img src="${iconUrl}" alt="${description || 'Weather icon'}" />` : ''}
        <div class="weather-current-info">
          <div class="weather-now-label">Now</div>
          <div class="weather-condition">${description}</div>
        </div>
      </div>
      <div class="weather-current-temp">${temp}</div>
    </div>
    <div class="weather-stats-row">
      <div class="weather-stat">
        <div class="weather-stat-label">Feels</div>
        <div class="weather-stat-value">${feelsLike}</div>
      </div>
      <div class="weather-stat">
        <div class="weather-stat-label">Wind</div>
        <div class="weather-stat-value">${windDisplay}</div>
      </div>
      <div class="weather-stat">
        <div class="weather-stat-label">Humidity</div>
        <div class="weather-stat-value">${humidity}</div>
      </div>
      ${additionalStats.join('')}
    </div>
  `;
}

function renderForecast(list) {
  const container = document.getElementById('weather-forecast');
  if (!container) return;
  if (!Array.isArray(list) || list.length === 0) {
    container.innerHTML = '<div class="card weather-empty">Forecast unavailable.</div>';
    return;
  }

  container.innerHTML = list.map(item => {
    const icon = item.weather?.[0]?.icon;
    const description = item.weather?.[0]?.description || '';
    const iconUrl = icon ? `https://openweathermap.org/img/wn/${icon}@2x.png` : '';

    const windSpeed = formatWindKmh(item.wind?.speed);
    const windDir = item.wind?.deg !== undefined ? getWindDirection(item.wind.deg) : null;
    const windDisplay = windDir ? `${windSpeed} ${windDir}` : windSpeed;
    const windGust = hasNumericValue(item.wind?.gust) ? `Gust ${Math.round(item.wind.gust * 3.6)} km/h` : null;

    const rain = formatPrecipMm(item.rain?.['3h']);
    const snow = formatPrecipMm(item.snow?.['3h']);

    const metaItems = [];
    metaItems.push(`üí® ${windDisplay}`);
    if (windGust) metaItems.push(windGust);
    metaItems.push(`üíß ${hasNumericValue(item.main?.humidity) ? `${Math.round(item.main.humidity)}%` : '‚Äî'}`);
    if (rain) metaItems.push(`üåßÔ∏è ${rain}`);
    if (snow) metaItems.push(`‚ùÑÔ∏è ${snow}`);

    return `
      <div class="card">
        <div style="display:flex;align-items:center;gap:12px;">
          ${iconUrl ? `<img src="${iconUrl}" alt="${description || 'Weather icon'}" style="width:44px;height:44px;" />` : ''}
          <div style="flex:1;">
            <div class="card-name">${formatDay(item.dt_txt)}</div>
            <div class="card-note" style="margin-bottom:0;text-transform:capitalize;">${description}</div>
          </div>
          <div style="text-align:right;">
            <div style="font-size:1.2rem;font-weight:800;color:var(--ocean);">${formatTemp(item.main?.temp_max)}</div>
            <div style="font-size:0.78rem;color:var(--text-light);">${formatTemp(item.main?.temp_min)} low</div>
          </div>
        </div>
        <div class="weather-meta" style="margin-top:8px;">
          ${metaItems.map(item => `<span>${item}</span>`).join('')}
        </div>
      </div>
    `;
  }).join('');
}

async function loadWeather() {
  if (weatherLoaded) return;
  const statusEl = document.getElementById('weather-status');
  if (statusEl) statusEl.textContent = 'Fetching live weather‚Ä¶';
  try {
    const response = await fetch(`/.netlify/functions/weather?lat=${WEATHER_COORDS.lat}&lon=${WEATHER_COORDS.lon}`);
    if (!response.ok) {
      throw new Error(`Weather error: ${response.status}`);
    }
    const payload = await response.json();
    if (!payload?.current || !payload?.forecast?.length) {
      throw new Error('Weather data incomplete.');
    }
    renderCurrentWeather(payload.current);
    renderForecast(payload.forecast);
    const updated = payload.updated ? new Date(payload.updated) : null;
    weatherLoaded = true;
    if (statusEl) {
      statusEl.textContent = updated
        ? `Updated ${updated.toLocaleString('en-CA', { dateStyle: 'medium', timeStyle: 'short' })}`
        : 'Updated just now.';
    }
  } catch (error) {
    console.error('Weather fetch error:', error);
    if (statusEl) {
      if (error.message && error.message.includes('404')) {
        statusEl.textContent = 'Weather service not configured. This site requires Netlify Functions.';
      } else if (error.message && error.message.includes('Weather error')) {
        statusEl.textContent = 'Weather service unavailable. Please try again later.';
      } else {
        statusEl.textContent = 'Unable to load live weather right now.';
      }
    }
    const forecastEl = document.getElementById('weather-forecast');
    if (forecastEl) {
      forecastEl.innerHTML = '<div class="card weather-empty">Live forecast unavailable. Check the links below.</div>';
    }
    const currentEl = document.getElementById('weather-current');
    if (currentEl) {
      currentEl.innerHTML = '<div class="weather-empty">Live conditions unavailable. Check the links below.</div>';
    }
    console.error(error);
  }
}

if (document.querySelector('.page.active')?.id === 'weather') {
  loadWeather();
}
</script>

</body>
</html>
